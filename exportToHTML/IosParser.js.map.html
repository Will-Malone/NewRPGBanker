<html>
<head>
<title>IosParser.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #6a8759;}
.s2 { color: #6897bb; font-style: italic;}
.s3 { color: #cc7832; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
IosParser.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/ios/IosParser.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;IosParser&quot;</span><span class="s0">,</span><span class="s1">&quot;splitMessages&quot;</span><span class="s0">,</span><span class="s1">&quot;raw&quot;</span><span class="s0">,</span><span class="s1">&quot;messages&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;timeRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;timeMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;nextMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;body&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;parseMessages&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;rawMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;headerMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;headerRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;priority&quot;</span><span class="s0">,</span><span class="s1">&quot;pid&quot;</span><span class="s0">,</span><span class="s1">&quot;tag&quot;</span><span class="s0">,</span><span class="s1">&quot;platform&quot;</span><span class="s0">,</span><span class="s1">&quot;date&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;parseInt&quot;</span><span class="s0">,</span><span class="s1">&quot;trim&quot;</span><span class="s0">,</span><span class="s1">&quot;Priority&quot;</span><span class="s0">,</span><span class="s1">&quot;fromName&quot;</span><span class="s0">,</span><span class="s1">&quot;reduce&quot;</span><span class="s0">,</span><span class="s1">&quot;acc&quot;</span><span class="s0">,</span><span class="s1">&quot;entry&quot;</span><span class="s0">,</span><span class="s1">&quot;isSame&quot;</span><span class="s0">,</span><span class="s1">&quot;appId&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import DayJS from 'dayjs';</span><span class="s3">\n</span><span class="s1">import { IParser, Entry } from '../types';</span><span class="s3">\n</span><span class="s1">import { Priority, PriorityNames } from './constants';</span><span class="s3">\n\n</span><span class="s1">export default class IosParser implements IParser {</span><span class="s3">\n  </span><span class="s1">static timeRegex: RegExp = /</span><span class="s3">\\</span><span class="s1">d{4}-</span><span class="s3">\\</span><span class="s1">d{2}-</span><span class="s3">\\</span><span class="s1">d{2}</span><span class="s3">\\</span><span class="s1">s</span><span class="s3">\\</span><span class="s1">d{2}:</span><span class="s3">\\</span><span class="s1">d{2}:</span><span class="s3">\\</span><span class="s1">d{2}</span><span class="s3">\\</span><span class="s1">.[</span><span class="s3">\\</span><span class="s1">d+]+/m;</span><span class="s3">\n  </span><span class="s1">static headerRegex: RegExp = /^</span><span class="s3">\\</span><span class="s1">s+[a-z0-9]+</span><span class="s3">\\</span><span class="s1">s+(</span><span class="s3">\\</span><span class="s1">w+)</span><span class="s3">\\</span><span class="s1">s+[a-z0-9]+</span><span class="s3">\\</span><span class="s1">s+(</span><span class="s3">\\</span><span class="s1">d+)</span><span class="s3">\\</span><span class="s1">s+</span><span class="s3">\\</span><span class="s1">d+</span><span class="s3">\\</span><span class="s1">s+([^:]+):/;</span><span class="s3">\n\n  </span><span class="s1">splitMessages(raw: string): string[] {</span><span class="s3">\n    </span><span class="s1">const messages: string[] = [];</span><span class="s3">\n    </span><span class="s1">let data = raw.toString();</span><span class="s3">\n    </span><span class="s1">let match = data.match(IosParser.timeRegex);</span><span class="s3">\n    </span><span class="s1">while (match) {</span><span class="s3">\n      </span><span class="s1">const timeMatch = match[0];</span><span class="s3">\n      </span><span class="s1">data = data.slice((match.index || 0) + timeMatch.length);</span><span class="s3">\n      </span><span class="s1">const nextMatch = data.match(IosParser.timeRegex);</span><span class="s3">\n      </span><span class="s1">const body = nextMatch ? data.slice(0, nextMatch.index) : data;</span><span class="s3">\n      </span><span class="s1">messages.push(`${timeMatch} ${body}`);</span><span class="s3">\n      </span><span class="s1">match = nextMatch;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return messages;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">parseMessages(messages: string[]): Entry[] {</span><span class="s3">\n    </span><span class="s1">return messages</span><span class="s3">\n      </span><span class="s1">.map(</span><span class="s3">\n        </span><span class="s1">(rawMessage: string): Entry =&gt; {</span><span class="s3">\n          </span><span class="s1">const timeMatch = rawMessage.match(IosParser.timeRegex);</span><span class="s3">\n          </span><span class="s1">if (!timeMatch) {</span><span class="s3">\n            </span><span class="s1">throw new Error(</span><span class="s3">\n              </span><span class="s1">`Time regex was not matched in message: ${rawMessage}`</span><span class="s3">\n            </span><span class="s1">);</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">const headerMatch = rawMessage</span><span class="s3">\n            </span><span class="s1">.slice(timeMatch[0].length)</span><span class="s3">\n            </span><span class="s1">.match(IosParser.headerRegex) || ['', 'Default', '-1', 'unknown'];</span><span class="s3">\n          </span><span class="s1">const [, priority, pid, tag] = headerMatch;</span><span class="s3">\n          </span><span class="s1">return {</span><span class="s3">\n            </span><span class="s1">platform: 'ios',</span><span class="s3">\n            </span><span class="s1">date: DayJS(timeMatch[0]).set('millisecond', 0),</span><span class="s3">\n            </span><span class="s1">pid: parseInt(pid.trim(), 10) || 0,</span><span class="s3">\n            </span><span class="s1">priority: Priority.fromName(priority as PriorityNames),</span><span class="s3">\n            </span><span class="s1">tag,</span><span class="s3">\n            </span><span class="s1">messages: [</span><span class="s3">\n              </span><span class="s1">rawMessage</span><span class="s3">\n                </span><span class="s1">.slice(timeMatch[0].length + headerMatch[0].length)</span><span class="s3">\n                </span><span class="s1">.trim(),</span><span class="s3">\n            </span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">};</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">.reduce((acc: Entry[], entry: Entry) =&gt; {</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">acc.length &gt; 0 &amp;&amp;</span><span class="s3">\n          </span><span class="s1">acc[acc.length - 1].date.isSame(entry.date) &amp;&amp;</span><span class="s3">\n          </span><span class="s1">acc[acc.length - 1].appId === entry.appId &amp;&amp;</span><span class="s3">\n          </span><span class="s1">acc[acc.length - 1].pid === entry.pid &amp;&amp;</span><span class="s3">\n          </span><span class="s1">acc[acc.length - 1].priority === entry.priority</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">acc[acc.length - 1].messages.push(...entry.messages);</span><span class="s3">\n          </span><span class="s1">return acc;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">return [...acc, entry];</span><span class="s3">\n      </span><span class="s1">}, []);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;file&quot;</span><span class="s0">:</span><span class="s1">&quot;IosParser.js&quot;</span><span class="s0">}</span></pre>
</body>
</html>