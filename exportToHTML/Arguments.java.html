<html>
<head>
<title>Arguments.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #629755; font-style: italic;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
.s6 { color: #629755; font-weight: bold; font-style: italic;}
.s7 { color: #77b767; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Arguments.java</font>
</center></td></tr></table>
<pre><span class="s0">/* 
 * Copyright (c) Meta Platforms, Inc. and affiliates. 
 * 
 * This source code is licensed under the MIT license found in the 
 * LICENSE file in the root directory of this source tree. 
 */</span>

<span class="s2">package </span><span class="s1">com.facebook.react.bridge</span><span class="s2">;</span>

<span class="s2">import </span><span class="s1">android.os.Bundle</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">android.os.Parcelable</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">androidx.annotation.Nullable</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">com.facebook.proguard.annotations.DoNotStrip</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">java.lang.reflect.Array</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">java.util.AbstractList</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">java.util.ArrayList</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">java.util.List</span><span class="s2">;</span>
<span class="s2">import </span><span class="s1">java.util.Map</span><span class="s2">;</span>

<span class="s1">@DoNotStrip</span>
<span class="s2">public class </span><span class="s1">Arguments {</span>
  <span class="s2">private static </span><span class="s1">Object makeNativeObject(Object object) {</span>
    <span class="s2">if </span><span class="s1">(object == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s2">return null;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(object </span><span class="s2">instanceof </span><span class="s1">Float</span>
        <span class="s1">|| object </span><span class="s2">instanceof </span><span class="s1">Long</span>
        <span class="s1">|| object </span><span class="s2">instanceof </span><span class="s1">Byte</span>
        <span class="s1">|| object </span><span class="s2">instanceof </span><span class="s1">Short) {</span>
      <span class="s2">return </span><span class="s1">((Number) object).doubleValue()</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(object.getClass().isArray()) {</span>
      <span class="s2">return </span><span class="s1">makeNativeArray(object)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(object </span><span class="s2">instanceof </span><span class="s1">List) {</span>
      <span class="s2">return </span><span class="s1">makeNativeArray((List) object)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(object </span><span class="s2">instanceof </span><span class="s1">Map) {</span>
      <span class="s2">return </span><span class="s1">makeNativeMap((Map&lt;String</span><span class="s2">, </span><span class="s1">Object&gt;) object)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(object </span><span class="s2">instanceof </span><span class="s1">Bundle) {</span>
      <span class="s2">return </span><span class="s1">makeNativeMap((Bundle) object)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
      <span class="s0">// Boolean, Integer, Double, String, WritableNativeArray, WritableNativeMap</span>
      <span class="s2">return </span><span class="s1">object</span><span class="s2">;</span>
    <span class="s1">}</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* This method converts a List into a NativeArray. The data types supported are boolean, int,</span>
   <span class="s3">* float, double, and String. List, Map, and Bundle objects, as well as arrays, containing values</span>
   <span class="s3">* of the above types and/or null, or any recursive arrangement of these, are also supported. The</span>
   <span class="s3">* best way to think of this is a way to generate a Java representation of a json list, from Java</span>
   <span class="s3">* types which have a natural representation in json.</span>
   <span class="s3">*/</span>
  <span class="s2">public static </span><span class="s1">WritableNativeArray makeNativeArray(List objects) {</span>
    <span class="s1">WritableNativeArray nativeArray = </span><span class="s2">new </span><span class="s1">WritableNativeArray()</span><span class="s2">;</span>
    <span class="s2">if </span><span class="s1">(objects == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s2">return </span><span class="s1">nativeArray</span><span class="s2">;</span>
    <span class="s1">}</span>
    <span class="s2">for </span><span class="s1">(Object elem : objects) {</span>
      <span class="s1">elem = makeNativeObject(elem)</span><span class="s2">;</span>
      <span class="s2">if </span><span class="s1">(elem == </span><span class="s2">null</span><span class="s1">) {</span>
        <span class="s1">nativeArray.pushNull()</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(elem </span><span class="s2">instanceof </span><span class="s1">Boolean) {</span>
        <span class="s1">nativeArray.pushBoolean((Boolean) elem)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(elem </span><span class="s2">instanceof </span><span class="s1">Integer) {</span>
        <span class="s1">nativeArray.pushInt((Integer) elem)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(elem </span><span class="s2">instanceof </span><span class="s1">Double) {</span>
        <span class="s1">nativeArray.pushDouble((Double) elem)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(elem </span><span class="s2">instanceof </span><span class="s1">String) {</span>
        <span class="s1">nativeArray.pushString((String) elem)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(elem </span><span class="s2">instanceof </span><span class="s1">WritableNativeArray) {</span>
        <span class="s1">nativeArray.pushArray((WritableNativeArray) elem)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(elem </span><span class="s2">instanceof </span><span class="s1">WritableNativeMap) {</span>
        <span class="s1">nativeArray.pushMap((WritableNativeMap) elem)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
        <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Could not convert &quot; </span><span class="s1">+ elem.getClass())</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">nativeArray</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* This overload is like the above, but uses reflection to operate on any primitive or object</span>
   <span class="s3">* type.</span>
   <span class="s3">*/</span>
  <span class="s2">public static </span><span class="s1">&lt;T&gt; WritableNativeArray makeNativeArray(</span><span class="s2">final </span><span class="s1">Object objects) {</span>
    <span class="s2">if </span><span class="s1">(objects == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s2">return new </span><span class="s1">WritableNativeArray()</span><span class="s2">;</span>
    <span class="s1">}</span>
    <span class="s0">// No explicit check for objects's type here.  If it's not an array, the</span>
    <span class="s0">// Array methods will throw IllegalArgumentException.</span>
    <span class="s2">return </span><span class="s1">makeNativeArray(</span>
        <span class="s2">new </span><span class="s1">AbstractList() {</span>
          <span class="s2">public int </span><span class="s1">size() {</span>
            <span class="s2">return </span><span class="s1">Array.getLength(objects)</span><span class="s2">;</span>
          <span class="s1">}</span>

          <span class="s2">public </span><span class="s1">Object get(</span><span class="s2">int </span><span class="s1">index) {</span>
            <span class="s2">return </span><span class="s1">Array.get(objects</span><span class="s2">, </span><span class="s1">index)</span><span class="s2">;</span>
          <span class="s1">}</span>
        <span class="s1">})</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s2">private static void </span><span class="s1">addEntry(WritableNativeMap nativeMap</span><span class="s2">, </span><span class="s1">String key</span><span class="s2">, </span><span class="s1">Object value) {</span>
    <span class="s1">value = makeNativeObject(value)</span><span class="s2">;</span>
    <span class="s2">if </span><span class="s1">(value == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s1">nativeMap.putNull(key)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">Boolean) {</span>
      <span class="s1">nativeMap.putBoolean(key</span><span class="s2">, </span><span class="s1">(Boolean) value)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">Integer) {</span>
      <span class="s1">nativeMap.putInt(key</span><span class="s2">, </span><span class="s1">(Integer) value)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">Number) {</span>
      <span class="s1">nativeMap.putDouble(key</span><span class="s2">, </span><span class="s1">((Number) value).doubleValue())</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">String) {</span>
      <span class="s1">nativeMap.putString(key</span><span class="s2">, </span><span class="s1">(String) value)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">WritableNativeArray) {</span>
      <span class="s1">nativeMap.putArray(key</span><span class="s2">, </span><span class="s1">(WritableNativeArray) value)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">WritableNativeMap) {</span>
      <span class="s1">nativeMap.putMap(key</span><span class="s2">, </span><span class="s1">(WritableNativeMap) value)</span><span class="s2">;</span>
    <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
      <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Could not convert &quot; </span><span class="s1">+ value.getClass())</span><span class="s2">;</span>
    <span class="s1">}</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* This method converts a Map into a NativeMap. Value types are supported as with makeNativeArray.</span>
   <span class="s3">* The best way to think of this is a way to generate a Java representation of a json object, from</span>
   <span class="s3">* Java types which have a natural representation in json.</span>
   <span class="s3">*/</span>
  <span class="s1">@DoNotStrip</span>
  <span class="s2">public static </span><span class="s1">WritableNativeMap makeNativeMap(Map&lt;String</span><span class="s2">, </span><span class="s1">Object&gt; objects) {</span>
    <span class="s1">WritableNativeMap nativeMap = </span><span class="s2">new </span><span class="s1">WritableNativeMap()</span><span class="s2">;</span>
    <span class="s2">if </span><span class="s1">(objects == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s2">return </span><span class="s1">nativeMap</span><span class="s2">;</span>
    <span class="s1">}</span>
    <span class="s2">for </span><span class="s1">(Map.Entry&lt;String</span><span class="s2">, </span><span class="s1">Object&gt; entry : objects.entrySet()) {</span>
      <span class="s1">addEntry(nativeMap</span><span class="s2">, </span><span class="s1">entry.getKey()</span><span class="s2">, </span><span class="s1">entry.getValue())</span><span class="s2">;</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">nativeMap</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/** Like the above, but takes a Bundle instead of a Map. */</span>
  <span class="s1">@DoNotStrip</span>
  <span class="s2">public static </span><span class="s1">WritableNativeMap makeNativeMap(Bundle bundle) {</span>
    <span class="s1">WritableNativeMap nativeMap = </span><span class="s2">new </span><span class="s1">WritableNativeMap()</span><span class="s2">;</span>
    <span class="s2">if </span><span class="s1">(bundle == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s2">return </span><span class="s1">nativeMap</span><span class="s2">;</span>
    <span class="s1">}</span>
    <span class="s2">for </span><span class="s1">(String key : bundle.keySet()) {</span>
      <span class="s1">addEntry(nativeMap</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">bundle.get(key))</span><span class="s2">;</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">nativeMap</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/** This method should be used when you need to stub out creating NativeArrays in unit tests. */</span>
  <span class="s2">public static </span><span class="s1">WritableArray createArray() {</span>
    <span class="s2">return new </span><span class="s1">WritableNativeArray()</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/** This method should be used when you need to stub out creating NativeMaps in unit tests. */</span>
  <span class="s2">public static </span><span class="s1">WritableMap createMap() {</span>
    <span class="s2">return new </span><span class="s1">WritableNativeMap()</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s2">public static </span><span class="s1">WritableNativeArray fromJavaArgs(Object[] args) {</span>
    <span class="s1">WritableNativeArray arguments = </span><span class="s2">new </span><span class="s1">WritableNativeArray()</span><span class="s2">;</span>
    <span class="s2">for </span><span class="s1">(</span><span class="s2">int </span><span class="s1">i = </span><span class="s5">0</span><span class="s2">; </span><span class="s1">i &lt; args.length</span><span class="s2">; </span><span class="s1">i++) {</span>
      <span class="s1">Object argument = args[i]</span><span class="s2">;</span>
      <span class="s2">if </span><span class="s1">(argument == </span><span class="s2">null</span><span class="s1">) {</span>
        <span class="s1">arguments.pushNull()</span><span class="s2">;</span>
        <span class="s2">continue;</span>
      <span class="s1">}</span>

      <span class="s1">Class argumentClass = argument.getClass()</span><span class="s2">;</span>
      <span class="s2">if </span><span class="s1">(argumentClass == Boolean.</span><span class="s2">class</span><span class="s1">) {</span>
        <span class="s1">arguments.pushBoolean(((Boolean) argument).booleanValue())</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(argumentClass == Integer.</span><span class="s2">class</span><span class="s1">) {</span>
        <span class="s1">arguments.pushDouble(((Integer) argument).doubleValue())</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(argumentClass == Double.</span><span class="s2">class</span><span class="s1">) {</span>
        <span class="s1">arguments.pushDouble(((Double) argument).doubleValue())</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(argumentClass == Float.</span><span class="s2">class</span><span class="s1">) {</span>
        <span class="s1">arguments.pushDouble(((Float) argument).doubleValue())</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(argumentClass == String.</span><span class="s2">class</span><span class="s1">) {</span>
        <span class="s1">arguments.pushString(argument.toString())</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(argumentClass == WritableNativeMap.</span><span class="s2">class</span><span class="s1">) {</span>
        <span class="s1">arguments.pushMap((WritableNativeMap) argument)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(argumentClass == WritableNativeArray.</span><span class="s2">class</span><span class="s1">) {</span>
        <span class="s1">arguments.pushArray((WritableNativeArray) argument)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
        <span class="s2">throw new </span><span class="s1">RuntimeException(</span><span class="s4">&quot;Cannot convert argument of type &quot; </span><span class="s1">+ argumentClass)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">arguments</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* Convert an array to a {</span><span class="s6">@link </span><span class="s3">WritableArray}.</span>
   <span class="s3">*</span>
   <span class="s3">* </span><span class="s6">@param </span><span class="s3">array the array to convert. Supported types are: {</span><span class="s6">@code </span><span class="s3">String[]}, {</span><span class="s6">@code </span><span class="s3">Bundle[]},</span>
   <span class="s3">*     {</span><span class="s6">@code </span><span class="s3">int[]}, {</span><span class="s6">@code </span><span class="s3">float[]}, {</span><span class="s6">@code </span><span class="s3">double[]}, {</span><span class="s6">@code </span><span class="s3">boolean[]}.</span>
   <span class="s3">* </span><span class="s6">@return </span><span class="s3">the converted {</span><span class="s6">@link </span><span class="s3">WritableArray}</span>
   <span class="s3">* </span><span class="s6">@throws </span><span class="s3">IllegalArgumentException if the passed object is none of the above types</span>
   <span class="s3">*/</span>
  <span class="s2">public static </span><span class="s1">WritableArray fromArray(Object array) {</span>
    <span class="s1">WritableArray catalystArray = createArray()</span><span class="s2">;</span>
    <span class="s2">if </span><span class="s1">(array </span><span class="s2">instanceof </span><span class="s1">String[]) {</span>
      <span class="s2">for </span><span class="s1">(String v : (String[]) array) {</span>
        <span class="s1">catalystArray.pushString(v)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(array </span><span class="s2">instanceof </span><span class="s1">Bundle[]) {</span>
      <span class="s2">for </span><span class="s1">(Bundle v : (Bundle[]) array) {</span>
        <span class="s1">catalystArray.pushMap(fromBundle(v))</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(array </span><span class="s2">instanceof int</span><span class="s1">[]) {</span>
      <span class="s2">for </span><span class="s1">(</span><span class="s2">int </span><span class="s1">v : (</span><span class="s2">int</span><span class="s1">[]) array) {</span>
        <span class="s1">catalystArray.pushInt(v)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(array </span><span class="s2">instanceof float</span><span class="s1">[]) {</span>
      <span class="s2">for </span><span class="s1">(</span><span class="s2">float </span><span class="s1">v : (</span><span class="s2">float</span><span class="s1">[]) array) {</span>
        <span class="s1">catalystArray.pushDouble(v)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(array </span><span class="s2">instanceof double</span><span class="s1">[]) {</span>
      <span class="s2">for </span><span class="s1">(</span><span class="s2">double </span><span class="s1">v : (</span><span class="s2">double</span><span class="s1">[]) array) {</span>
        <span class="s1">catalystArray.pushDouble(v)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(array </span><span class="s2">instanceof boolean</span><span class="s1">[]) {</span>
      <span class="s2">for </span><span class="s1">(</span><span class="s2">boolean </span><span class="s1">v : (</span><span class="s2">boolean</span><span class="s1">[]) array) {</span>
        <span class="s1">catalystArray.pushBoolean(v)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s2">else if </span><span class="s1">(array </span><span class="s2">instanceof </span><span class="s1">Parcelable[]) {</span>
      <span class="s2">for </span><span class="s1">(Parcelable v : (Parcelable[]) array) {</span>
        <span class="s2">if </span><span class="s1">(v </span><span class="s2">instanceof </span><span class="s1">Bundle) {</span>
          <span class="s1">catalystArray.pushMap(fromBundle((Bundle) v))</span><span class="s2">;</span>
        <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
          <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Unexpected array member type &quot; </span><span class="s1">+ v.getClass())</span><span class="s2">;</span>
        <span class="s1">}</span>
      <span class="s1">}</span>
    <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
      <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Unknown array type &quot; </span><span class="s1">+ array.getClass())</span><span class="s2">;</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">catalystArray</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* Convert a {</span><span class="s6">@link </span><span class="s3">List} to a {</span><span class="s6">@link </span><span class="s3">WritableArray}.</span>
   <span class="s3">*</span>
   <span class="s3">* </span><span class="s6">@param </span><span class="s3">list the list to convert. Supported value types are: {</span><span class="s6">@code </span><span class="s3">null}, {</span><span class="s6">@code </span><span class="s3">String},</span>
   <span class="s3">*     {</span><span class="s6">@code </span><span class="s3">Bundle}, {</span><span class="s6">@code </span><span class="s3">List}, {</span><span class="s6">@code </span><span class="s3">Number}, {</span><span class="s6">@code </span><span class="s3">Boolean}, and all array types</span>
   <span class="s3">*     supported in {</span><span class="s6">@link </span><span class="s3">#fromArray(Object)}.</span>
   <span class="s3">* </span><span class="s6">@return </span><span class="s3">the converted {</span><span class="s6">@link </span><span class="s3">WritableArray}</span>
   <span class="s3">* </span><span class="s6">@throws </span><span class="s3">IllegalArgumentException if one of the values from the passed list is none of the above</span>
   <span class="s3">*     types</span>
   <span class="s3">*/</span>
  <span class="s2">public static </span><span class="s1">WritableArray fromList(List list) {</span>
    <span class="s1">WritableArray catalystArray = createArray()</span><span class="s2">;</span>
    <span class="s2">for </span><span class="s1">(Object obj : list) {</span>
      <span class="s2">if </span><span class="s1">(obj == </span><span class="s2">null</span><span class="s1">) {</span>
        <span class="s1">catalystArray.pushNull()</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(obj.getClass().isArray()) {</span>
        <span class="s1">catalystArray.pushArray(fromArray(obj))</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(obj </span><span class="s2">instanceof </span><span class="s1">Bundle) {</span>
        <span class="s1">catalystArray.pushMap(fromBundle((Bundle) obj))</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(obj </span><span class="s2">instanceof </span><span class="s1">List) {</span>
        <span class="s1">catalystArray.pushArray(fromList((List) obj))</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(obj </span><span class="s2">instanceof </span><span class="s1">String) {</span>
        <span class="s1">catalystArray.pushString((String) obj)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(obj </span><span class="s2">instanceof </span><span class="s1">Integer) {</span>
        <span class="s1">catalystArray.pushInt((Integer) obj)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(obj </span><span class="s2">instanceof </span><span class="s1">Number) {</span>
        <span class="s1">catalystArray.pushDouble(((Number) obj).doubleValue())</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(obj </span><span class="s2">instanceof </span><span class="s1">Boolean) {</span>
        <span class="s1">catalystArray.pushBoolean((Boolean) obj)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
        <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Unknown value type &quot; </span><span class="s1">+ obj.getClass())</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">catalystArray</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* Convert a {</span><span class="s6">@link </span><span class="s3">Bundle} to a {</span><span class="s6">@link </span><span class="s3">WritableMap}. Supported key types in the bundle are:</span>
   <span class="s3">*</span>
   <span class="s3">* </span><span class="s7">&lt;p&gt;</span>
   <span class="s3">*</span>
   <span class="s3">* </span><span class="s7">&lt;ul&gt;</span>
   <span class="s3">*   </span><span class="s7">&lt;li&gt;</span><span class="s3">primitive types: int, float, double, boolean</span>
   <span class="s3">*   </span><span class="s7">&lt;li&gt;</span><span class="s3">arrays supported by {</span><span class="s6">@link </span><span class="s3">#fromArray(Object)}</span>
   <span class="s3">*   </span><span class="s7">&lt;li&gt;</span><span class="s3">lists supported by {</span><span class="s6">@link </span><span class="s3">#fromList(List)}</span>
   <span class="s3">*   </span><span class="s7">&lt;li&gt;</span><span class="s3">{</span><span class="s6">@link </span><span class="s3">Bundle} objects that are recursively converted to maps</span>
   <span class="s3">* </span><span class="s7">&lt;/ul&gt;</span>
   <span class="s3">*</span>
   <span class="s3">* </span><span class="s6">@param </span><span class="s3">bundle the {</span><span class="s6">@link </span><span class="s3">Bundle} to convert</span>
   <span class="s3">* </span><span class="s6">@return </span><span class="s3">the converted {</span><span class="s6">@link </span><span class="s3">WritableMap}</span>
   <span class="s3">* </span><span class="s6">@throws </span><span class="s3">IllegalArgumentException if there are keys of unsupported types</span>
   <span class="s3">*/</span>
  <span class="s2">public static </span><span class="s1">WritableMap fromBundle(Bundle bundle) {</span>
    <span class="s1">WritableMap map = createMap()</span><span class="s2">;</span>
    <span class="s2">for </span><span class="s1">(String key : bundle.keySet()) {</span>
      <span class="s1">Object value = bundle.get(key)</span><span class="s2">;</span>
      <span class="s2">if </span><span class="s1">(value == </span><span class="s2">null</span><span class="s1">) {</span>
        <span class="s1">map.putNull(key)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value.getClass().isArray()) {</span>
        <span class="s1">map.putArray(key</span><span class="s2">, </span><span class="s1">fromArray(value))</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">String) {</span>
        <span class="s1">map.putString(key</span><span class="s2">, </span><span class="s1">(String) value)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">Number) {</span>
        <span class="s2">if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">Integer) {</span>
          <span class="s1">map.putInt(key</span><span class="s2">, </span><span class="s1">(Integer) value)</span><span class="s2">;</span>
        <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
          <span class="s1">map.putDouble(key</span><span class="s2">, </span><span class="s1">((Number) value).doubleValue())</span><span class="s2">;</span>
        <span class="s1">}</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">Boolean) {</span>
        <span class="s1">map.putBoolean(key</span><span class="s2">, </span><span class="s1">(Boolean) value)</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">Bundle) {</span>
        <span class="s1">map.putMap(key</span><span class="s2">, </span><span class="s1">fromBundle((Bundle) value))</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else if </span><span class="s1">(value </span><span class="s2">instanceof </span><span class="s1">List) {</span>
        <span class="s1">map.putArray(key</span><span class="s2">, </span><span class="s1">fromList((List) value))</span><span class="s2">;</span>
      <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
        <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Could not convert &quot; </span><span class="s1">+ value.getClass())</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">return </span><span class="s1">map</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* Convert a {</span><span class="s6">@link </span><span class="s3">WritableArray} to a {</span><span class="s6">@link </span><span class="s3">ArrayList}.</span>
   <span class="s3">*</span>
   <span class="s3">* </span><span class="s6">@param </span><span class="s3">readableArray the {</span><span class="s6">@link </span><span class="s3">WritableArray} to convert.</span>
   <span class="s3">* </span><span class="s6">@return </span><span class="s3">the converted {</span><span class="s6">@link </span><span class="s3">ArrayList}.</span>
   <span class="s3">*/</span>
  <span class="s1">@Nullable</span>
  <span class="s2">public static </span><span class="s1">ArrayList toList(@Nullable ReadableArray readableArray) {</span>
    <span class="s2">if </span><span class="s1">(readableArray == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s2">return null;</span>
    <span class="s1">}</span>

    <span class="s1">ArrayList list = </span><span class="s2">new </span><span class="s1">ArrayList()</span><span class="s2">;</span>

    <span class="s2">for </span><span class="s1">(</span><span class="s2">int </span><span class="s1">i = </span><span class="s5">0</span><span class="s2">; </span><span class="s1">i &lt; readableArray.size()</span><span class="s2">; </span><span class="s1">i++) {</span>
      <span class="s2">switch </span><span class="s1">(readableArray.getType(i)) {</span>
        <span class="s2">case </span><span class="s1">Null:</span>
          <span class="s1">list.add(</span><span class="s2">null</span><span class="s1">)</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Boolean:</span>
          <span class="s1">list.add(readableArray.getBoolean(i))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Number:</span>
          <span class="s2">double </span><span class="s1">number = readableArray.getDouble(i)</span><span class="s2">;</span>
          <span class="s2">if </span><span class="s1">(number == Math.rint(number)) {</span>
            <span class="s0">// Add as an integer</span>
            <span class="s1">list.add((</span><span class="s2">int</span><span class="s1">) number)</span><span class="s2">;</span>
          <span class="s1">} </span><span class="s2">else </span><span class="s1">{</span>
            <span class="s0">// Add as a double</span>
            <span class="s1">list.add(number)</span><span class="s2">;</span>
          <span class="s1">}</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">String:</span>
          <span class="s1">list.add(readableArray.getString(i))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Map:</span>
          <span class="s1">list.add(toBundle(readableArray.getMap(i)))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Array:</span>
          <span class="s1">list.add(toList(readableArray.getArray(i)))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">default</span><span class="s1">:</span>
          <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Could not convert object in array.&quot;</span><span class="s1">)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s2">return </span><span class="s1">list</span><span class="s2">;</span>
  <span class="s1">}</span>

  <span class="s3">/**</span>
   <span class="s3">* Convert a {</span><span class="s6">@link </span><span class="s3">WritableMap} to a {</span><span class="s6">@link </span><span class="s3">Bundle}. Note: Each array is converted to an {</span><span class="s6">@link</span>
   <span class="s3">* ArrayList}.</span>
   <span class="s3">*</span>
   <span class="s3">* </span><span class="s6">@param </span><span class="s3">readableMap the {</span><span class="s6">@link </span><span class="s3">WritableMap} to convert.</span>
   <span class="s3">* </span><span class="s6">@return </span><span class="s3">the converted {</span><span class="s6">@link </span><span class="s3">Bundle}.</span>
   <span class="s3">*/</span>
  <span class="s1">@Nullable</span>
  <span class="s2">public static </span><span class="s1">Bundle toBundle(@Nullable ReadableMap readableMap) {</span>
    <span class="s2">if </span><span class="s1">(readableMap == </span><span class="s2">null</span><span class="s1">) {</span>
      <span class="s2">return null;</span>
    <span class="s1">}</span>

    <span class="s1">ReadableMapKeySetIterator iterator = readableMap.keySetIterator()</span><span class="s2">;</span>

    <span class="s1">Bundle bundle = </span><span class="s2">new </span><span class="s1">Bundle()</span><span class="s2">;</span>
    <span class="s2">while </span><span class="s1">(iterator.hasNextKey()) {</span>
      <span class="s1">String key = iterator.nextKey()</span><span class="s2">;</span>
      <span class="s1">ReadableType readableType = readableMap.getType(key)</span><span class="s2">;</span>
      <span class="s2">switch </span><span class="s1">(readableType) {</span>
        <span class="s2">case </span><span class="s1">Null:</span>
          <span class="s1">bundle.putString(key</span><span class="s2">, null</span><span class="s1">)</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Boolean:</span>
          <span class="s1">bundle.putBoolean(key</span><span class="s2">, </span><span class="s1">readableMap.getBoolean(key))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Number:</span>
          <span class="s0">// Can be int or double.</span>
          <span class="s1">bundle.putDouble(key</span><span class="s2">, </span><span class="s1">readableMap.getDouble(key))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">String:</span>
          <span class="s1">bundle.putString(key</span><span class="s2">, </span><span class="s1">readableMap.getString(key))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Map:</span>
          <span class="s1">bundle.putBundle(key</span><span class="s2">, </span><span class="s1">toBundle(readableMap.getMap(key)))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">case </span><span class="s1">Array:</span>
          <span class="s1">bundle.putSerializable(key</span><span class="s2">, </span><span class="s1">toList(readableMap.getArray(key)))</span><span class="s2">;</span>
          <span class="s2">break;</span>
        <span class="s2">default</span><span class="s1">:</span>
          <span class="s2">throw new </span><span class="s1">IllegalArgumentException(</span><span class="s4">&quot;Could not convert object with key: &quot; </span><span class="s1">+ key + </span><span class="s4">&quot;.&quot;</span><span class="s1">)</span><span class="s2">;</span>
      <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s2">return </span><span class="s1">bundle</span><span class="s2">;</span>
  <span class="s1">}</span>
<span class="s1">}</span>
</pre>
</body>
</html>