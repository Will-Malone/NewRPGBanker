<html>
<head>
<title>class-scope.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #6a8759;}
.s2 { color: #6897bb; font-style: italic;}
.s3 { color: #cc7832; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
class-scope.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;_scopeflags&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;_parseError&quot;</span><span class="s0">,</span><span class="s1">&quot;ClassScope&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;privateNames&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;loneAccessors&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;undefinedPrivateNames&quot;</span><span class="s0">,</span><span class="s1">&quot;exports&quot;</span><span class="s0">,</span><span class="s1">&quot;ClassScopeHandler&quot;</span><span class="s0">,</span><span class="s1">&quot;parser&quot;</span><span class="s0">,</span><span class="s1">&quot;stack&quot;</span><span class="s0">,</span><span class="s1">&quot;current&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;enter&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;exit&quot;</span><span class="s0">,</span><span class="s1">&quot;oldClassScope&quot;</span><span class="s0">,</span><span class="s1">&quot;pop&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;loc&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;raise&quot;</span><span class="s0">,</span><span class="s1">&quot;Errors&quot;</span><span class="s0">,</span><span class="s1">&quot;InvalidPrivateFieldResolution&quot;</span><span class="s0">,</span><span class="s1">&quot;at&quot;</span><span class="s0">,</span><span class="s1">&quot;identifierName&quot;</span><span class="s0">,</span><span class="s1">&quot;declarePrivateName&quot;</span><span class="s0">,</span><span class="s1">&quot;elementType&quot;</span><span class="s0">,</span><span class="s1">&quot;redefined&quot;</span><span class="s0">,</span><span class="s1">&quot;CLASS_ELEMENT_KIND_ACCESSOR&quot;</span><span class="s0">,</span><span class="s1">&quot;accessor&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;oldStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;CLASS_ELEMENT_FLAG_STATIC&quot;</span><span class="s0">,</span><span class="s1">&quot;newStatic&quot;</span><span class="s0">,</span><span class="s1">&quot;oldKind&quot;</span><span class="s0">,</span><span class="s1">&quot;newKind&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;PrivateNameRedeclaration&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;usePrivateName&quot;</span><span class="s0">,</span><span class="s1">&quot;classScope&quot;</span><span class="s0">,</span><span class="s1">&quot;default&quot;</span><span class="s0">],</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/util/class-scope.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">CLASS_ELEMENT_KIND_ACCESSOR,</span><span class="s3">\n  </span><span class="s1">CLASS_ELEMENT_FLAG_STATIC,</span><span class="s3">\n  </span><span class="s1">type ClassElementTypes,</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./scopeflags</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type { Position } from </span><span class="s3">\&quot;</span><span class="s1">./location</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import { Errors } from </span><span class="s3">\&quot;</span><span class="s1">../parse-error</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type Tokenizer from </span><span class="s3">\&quot;</span><span class="s1">../tokenizer</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">export class ClassScope {</span><span class="s3">\n  </span><span class="s1">// A list of private named declared in the current class</span><span class="s3">\n  </span><span class="s1">privateNames: Set&lt;string&gt; = new Set();</span><span class="s3">\n\n  </span><span class="s1">// A list of private getters of setters without their counterpart</span><span class="s3">\n  </span><span class="s1">loneAccessors: Map&lt;string, ClassElementTypes&gt; = new Map();</span><span class="s3">\n\n  </span><span class="s1">// A list of private names used before being defined, mapping to</span><span class="s3">\n  </span><span class="s1">// their position.</span><span class="s3">\n  </span><span class="s1">undefinedPrivateNames: Map&lt;string, Position&gt; = new Map();</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export default class ClassScopeHandler {</span><span class="s3">\n  </span><span class="s1">parser: Tokenizer;</span><span class="s3">\n  </span><span class="s1">stack: Array&lt;ClassScope&gt; = [];</span><span class="s3">\n  </span><span class="s1">undefinedPrivateNames: Map&lt;string, Position&gt; = new Map();</span><span class="s3">\n\n  </span><span class="s1">constructor(parser: Tokenizer) {</span><span class="s3">\n    </span><span class="s1">this.parser = parser;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">current(): ClassScope {</span><span class="s3">\n    </span><span class="s1">return this.stack[this.stack.length - 1];</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">enter() {</span><span class="s3">\n    </span><span class="s1">this.stack.push(new ClassScope());</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">exit() {</span><span class="s3">\n    </span><span class="s1">const oldClassScope = this.stack.pop();</span><span class="s3">\n\n    </span><span class="s1">// Migrate the usage of not yet defined private names to the outer</span><span class="s3">\n    </span><span class="s1">// class scope, or raise an error if we reached the top-level scope.</span><span class="s3">\n\n    </span><span class="s1">const current = this.current();</span><span class="s3">\n\n    </span><span class="s1">// Array.from is needed because this is compiled to an array-like for loop</span><span class="s3">\n    </span><span class="s1">for (const [name, loc] of Array.from(oldClassScope.undefinedPrivateNames)) {</span><span class="s3">\n      </span><span class="s1">if (current) {</span><span class="s3">\n        </span><span class="s1">if (!current.undefinedPrivateNames.has(name)) {</span><span class="s3">\n          </span><span class="s1">current.undefinedPrivateNames.set(name, loc);</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">this.parser.raise(Errors.InvalidPrivateFieldResolution, {</span><span class="s3">\n          </span><span class="s1">at: loc,</span><span class="s3">\n          </span><span class="s1">identifierName: name,</span><span class="s3">\n        </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">declarePrivateName(</span><span class="s3">\n    </span><span class="s1">name: string,</span><span class="s3">\n    </span><span class="s1">elementType: ClassElementTypes,</span><span class="s3">\n    </span><span class="s1">loc: Position,</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">const { privateNames, loneAccessors, undefinedPrivateNames } =</span><span class="s3">\n      </span><span class="s1">this.current();</span><span class="s3">\n    </span><span class="s1">let redefined = privateNames.has(name);</span><span class="s3">\n\n    </span><span class="s1">if (elementType &amp; CLASS_ELEMENT_KIND_ACCESSOR) {</span><span class="s3">\n      </span><span class="s1">const accessor = redefined &amp;&amp; loneAccessors.get(name);</span><span class="s3">\n      </span><span class="s1">if (accessor) {</span><span class="s3">\n        </span><span class="s1">const oldStatic = accessor &amp; CLASS_ELEMENT_FLAG_STATIC;</span><span class="s3">\n        </span><span class="s1">const newStatic = elementType &amp; CLASS_ELEMENT_FLAG_STATIC;</span><span class="s3">\n\n        </span><span class="s1">const oldKind = accessor &amp; CLASS_ELEMENT_KIND_ACCESSOR;</span><span class="s3">\n        </span><span class="s1">const newKind = elementType &amp; CLASS_ELEMENT_KIND_ACCESSOR;</span><span class="s3">\n\n        </span><span class="s1">// The private name can be duplicated only if it is used by</span><span class="s3">\n        </span><span class="s1">// two accessors with different kind (get and set), and if</span><span class="s3">\n        </span><span class="s1">// they have the same placement (static or not).</span><span class="s3">\n        </span><span class="s1">redefined = oldKind === newKind || oldStatic !== newStatic;</span><span class="s3">\n\n        </span><span class="s1">if (!redefined) loneAccessors.delete(name);</span><span class="s3">\n      </span><span class="s1">} else if (!redefined) {</span><span class="s3">\n        </span><span class="s1">loneAccessors.set(name, elementType);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (redefined) {</span><span class="s3">\n      </span><span class="s1">this.parser.raise(Errors.PrivateNameRedeclaration, {</span><span class="s3">\n        </span><span class="s1">at: loc,</span><span class="s3">\n        </span><span class="s1">identifierName: name,</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">privateNames.add(name);</span><span class="s3">\n    </span><span class="s1">undefinedPrivateNames.delete(name);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">usePrivateName(name: string, loc: Position) {</span><span class="s3">\n    </span><span class="s1">let classScope;</span><span class="s3">\n    </span><span class="s1">for (classScope of this.stack) {</span><span class="s3">\n      </span><span class="s1">if (classScope.privateNames.has(name)) return;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (classScope) {</span><span class="s3">\n      </span><span class="s1">classScope.undefinedPrivateNames.set(name, loc);</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">// top-level</span><span class="s3">\n      </span><span class="s1">this.parser.raise(Errors.InvalidPrivateFieldResolution, {</span><span class="s3">\n        </span><span class="s1">at: loc,</span><span class="s3">\n        </span><span class="s1">identifierName: name,</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">}</span></pre>
</body>
</html>