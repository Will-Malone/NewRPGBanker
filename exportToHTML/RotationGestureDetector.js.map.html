<html>
<head>
<title>RotationGestureDetector.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #6a8759;}
.s2 { color: #6897bb; font-style: italic;}
.s3 { color: #cc7832; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
RotationGestureDetector.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;RotationGestureDetector.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;RotationGestureDetector&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;callbacks&quot;</span><span class="s0">,</span><span class="s1">&quot;NaN&quot;</span><span class="s0">,</span><span class="s1">&quot;onRotationBegin&quot;</span><span class="s0">,</span><span class="s1">&quot;onRotation&quot;</span><span class="s0">,</span><span class="s1">&quot;onRotationEnd&quot;</span><span class="s0">,</span><span class="s1">&quot;updateCurrent&quot;</span><span class="s0">,</span><span class="s1">&quot;event&quot;</span><span class="s0">,</span><span class="s1">&quot;tracker&quot;</span><span class="s0">,</span><span class="s1">&quot;previousTime&quot;</span><span class="s0">,</span><span class="s1">&quot;currentTime&quot;</span><span class="s0">,</span><span class="s1">&quot;time&quot;</span><span class="s0">,</span><span class="s1">&quot;firstPointerID&quot;</span><span class="s0">,</span><span class="s1">&quot;secondPointerID&quot;</span><span class="s0">,</span><span class="s1">&quot;keyPointers&quot;</span><span class="s0">,</span><span class="s1">&quot;firstPointerX&quot;</span><span class="s0">,</span><span class="s1">&quot;getLastX&quot;</span><span class="s0">,</span><span class="s1">&quot;firstPointerY&quot;</span><span class="s0">,</span><span class="s1">&quot;getLastY&quot;</span><span class="s0">,</span><span class="s1">&quot;secondPointerX&quot;</span><span class="s0">,</span><span class="s1">&quot;secondPointerY&quot;</span><span class="s0">,</span><span class="s1">&quot;vectorX&quot;</span><span class="s0">,</span><span class="s1">&quot;vectorY&quot;</span><span class="s0">,</span><span class="s1">&quot;anchorX&quot;</span><span class="s0">,</span><span class="s1">&quot;anchorY&quot;</span><span class="s0">,</span><span class="s1">&quot;angle&quot;</span><span class="s0">,</span><span class="s1">&quot;Math&quot;</span><span class="s0">,</span><span class="s1">&quot;atan2&quot;</span><span class="s0">,</span><span class="s1">&quot;rotation&quot;</span><span class="s0">,</span><span class="s1">&quot;Number&quot;</span><span class="s0">,</span><span class="s1">&quot;isNaN&quot;</span><span class="s0">,</span><span class="s1">&quot;previousAngle&quot;</span><span class="s0">,</span><span class="s1">&quot;PI&quot;</span><span class="s0">,</span><span class="s1">&quot;finish&quot;</span><span class="s0">,</span><span class="s1">&quot;isInProgress&quot;</span><span class="s0">,</span><span class="s1">&quot;setKeyPointers&quot;</span><span class="s0">,</span><span class="s1">&quot;pointerIDs&quot;</span><span class="s0">,</span><span class="s1">&quot;getData&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;next&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;onTouchEvent&quot;</span><span class="s0">,</span><span class="s1">&quot;eventType&quot;</span><span class="s0">,</span><span class="s1">&quot;EventTypes&quot;</span><span class="s0">,</span><span class="s1">&quot;DOWN&quot;</span><span class="s0">,</span><span class="s1">&quot;ADDITIONAL_POINTER_DOWN&quot;</span><span class="s0">,</span><span class="s1">&quot;MOVE&quot;</span><span class="s0">,</span><span class="s1">&quot;ADDITIONAL_POINTER_UP&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;pointerId&quot;</span><span class="s0">,</span><span class="s1">&quot;UP&quot;</span><span class="s0">,</span><span class="s1">&quot;getTimeDelta&quot;</span><span class="s0">,</span><span class="s1">&quot;getAnchorX&quot;</span><span class="s0">,</span><span class="s1">&quot;getAnchorY&quot;</span><span class="s0">,</span><span class="s1">&quot;getRotation&quot;</span><span class="s0">,</span><span class="s1">&quot;reset&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { AdaptedEvent, EventTypes } from '../interfaces';</span><span class="s3">\n</span><span class="s1">import PointerTracker from '../tools/PointerTracker';</span><span class="s3">\n\n</span><span class="s1">export interface RotationGestureListener {</span><span class="s3">\n  </span><span class="s1">onRotationBegin: (detector: RotationGestureDetector) =&gt; boolean;</span><span class="s3">\n  </span><span class="s1">onRotation: (detector: RotationGestureDetector) =&gt; boolean;</span><span class="s3">\n  </span><span class="s1">onRotationEnd: (detector: RotationGestureDetector) =&gt; void;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export default class RotationGestureDetector</span><span class="s3">\n  </span><span class="s1">implements RotationGestureListener</span><span class="s3">\n</span><span class="s1">{</span><span class="s3">\n  </span><span class="s1">onRotationBegin: (detector: RotationGestureDetector) =&gt; boolean;</span><span class="s3">\n  </span><span class="s1">onRotation: (detector: RotationGestureDetector) =&gt; boolean;</span><span class="s3">\n  </span><span class="s1">onRotationEnd: (detector: RotationGestureDetector) =&gt; void;</span><span class="s3">\n\n  </span><span class="s1">private currentTime = 0;</span><span class="s3">\n  </span><span class="s1">private previousTime = 0;</span><span class="s3">\n\n  </span><span class="s1">private previousAngle = 0;</span><span class="s3">\n  </span><span class="s1">private rotation = 0;</span><span class="s3">\n\n  </span><span class="s1">private anchorX = 0;</span><span class="s3">\n  </span><span class="s1">private anchorY = 0;</span><span class="s3">\n\n  </span><span class="s1">private isInProgress = false;</span><span class="s3">\n\n  </span><span class="s1">private keyPointers: number[] = [NaN, NaN];</span><span class="s3">\n\n  </span><span class="s1">constructor(callbacks: RotationGestureListener) {</span><span class="s3">\n    </span><span class="s1">this.onRotationBegin = callbacks.onRotationBegin;</span><span class="s3">\n    </span><span class="s1">this.onRotation = callbacks.onRotation;</span><span class="s3">\n    </span><span class="s1">this.onRotationEnd = callbacks.onRotationEnd;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private updateCurrent(event: AdaptedEvent, tracker: PointerTracker): void {</span><span class="s3">\n    </span><span class="s1">this.previousTime = this.currentTime;</span><span class="s3">\n    </span><span class="s1">this.currentTime = event.time;</span><span class="s3">\n\n    </span><span class="s1">const [firstPointerID, secondPointerID] = this.keyPointers;</span><span class="s3">\n\n    </span><span class="s1">const firstPointerX: number = tracker.getLastX(firstPointerID);</span><span class="s3">\n    </span><span class="s1">const firstPointerY: number = tracker.getLastY(firstPointerID);</span><span class="s3">\n    </span><span class="s1">const secondPointerX: number = tracker.getLastX(secondPointerID);</span><span class="s3">\n    </span><span class="s1">const secondPointerY: number = tracker.getLastY(secondPointerID);</span><span class="s3">\n\n    </span><span class="s1">const vectorX: number = secondPointerX - firstPointerX;</span><span class="s3">\n    </span><span class="s1">const vectorY: number = secondPointerY - firstPointerY;</span><span class="s3">\n\n    </span><span class="s1">this.anchorX = (firstPointerX + secondPointerX) / 2;</span><span class="s3">\n    </span><span class="s1">this.anchorY = (firstPointerY + secondPointerY) / 2;</span><span class="s3">\n\n    </span><span class="s1">//Angle diff should be positive when rotating in clockwise direction</span><span class="s3">\n    </span><span class="s1">const angle: number = -Math.atan2(vectorY, vectorX);</span><span class="s3">\n\n    </span><span class="s1">this.rotation = Number.isNaN(this.previousAngle)</span><span class="s3">\n      </span><span class="s1">? 0</span><span class="s3">\n      </span><span class="s1">: this.previousAngle - angle;</span><span class="s3">\n\n    </span><span class="s1">this.previousAngle = angle;</span><span class="s3">\n\n    </span><span class="s1">if (this.rotation &gt; Math.PI) {</span><span class="s3">\n      </span><span class="s1">this.rotation -= Math.PI;</span><span class="s3">\n    </span><span class="s1">} else if (this.rotation &lt; -Math.PI) {</span><span class="s3">\n      </span><span class="s1">this.rotation += Math.PI;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (this.rotation &gt; Math.PI / 2) {</span><span class="s3">\n      </span><span class="s1">this.rotation -= Math.PI;</span><span class="s3">\n    </span><span class="s1">} else if (this.rotation &lt; -Math.PI / 2) {</span><span class="s3">\n      </span><span class="s1">this.rotation += Math.PI;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private finish(): void {</span><span class="s3">\n    </span><span class="s1">if (!this.isInProgress) {</span><span class="s3">\n      </span><span class="s1">return;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">this.isInProgress = false;</span><span class="s3">\n    </span><span class="s1">this.keyPointers = [NaN, NaN];</span><span class="s3">\n    </span><span class="s1">this.onRotationEnd(this);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">private setKeyPointers(tracker: PointerTracker): void {</span><span class="s3">\n    </span><span class="s1">if (this.keyPointers[0] &amp;&amp; this.keyPointers[1]) {</span><span class="s3">\n      </span><span class="s1">return;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const pointerIDs: IterableIterator&lt;number&gt; = tracker.getData().keys();</span><span class="s3">\n\n    </span><span class="s1">this.keyPointers[0] = pointerIDs.next().value as number;</span><span class="s3">\n    </span><span class="s1">this.keyPointers[1] = pointerIDs.next().value as number;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public onTouchEvent(event: AdaptedEvent, tracker: PointerTracker): boolean {</span><span class="s3">\n    </span><span class="s1">switch (event.eventType) {</span><span class="s3">\n      </span><span class="s1">case EventTypes.DOWN:</span><span class="s3">\n        </span><span class="s1">this.isInProgress = false;</span><span class="s3">\n        </span><span class="s1">break;</span><span class="s3">\n\n      </span><span class="s1">case EventTypes.ADDITIONAL_POINTER_DOWN:</span><span class="s3">\n        </span><span class="s1">if (this.isInProgress) {</span><span class="s3">\n          </span><span class="s1">break;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">this.isInProgress = true;</span><span class="s3">\n\n        </span><span class="s1">this.previousTime = event.time;</span><span class="s3">\n        </span><span class="s1">this.previousAngle = NaN;</span><span class="s3">\n\n        </span><span class="s1">this.setKeyPointers(tracker);</span><span class="s3">\n\n        </span><span class="s1">this.updateCurrent(event, tracker);</span><span class="s3">\n        </span><span class="s1">this.onRotationBegin(this);</span><span class="s3">\n        </span><span class="s1">break;</span><span class="s3">\n\n      </span><span class="s1">case EventTypes.MOVE:</span><span class="s3">\n        </span><span class="s1">if (!this.isInProgress) {</span><span class="s3">\n          </span><span class="s1">break;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">this.updateCurrent(event, tracker);</span><span class="s3">\n        </span><span class="s1">this.onRotation(this);</span><span class="s3">\n\n        </span><span class="s1">break;</span><span class="s3">\n\n      </span><span class="s1">case EventTypes.ADDITIONAL_POINTER_UP:</span><span class="s3">\n        </span><span class="s1">if (!this.isInProgress) {</span><span class="s3">\n          </span><span class="s1">break;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (this.keyPointers.indexOf(event.pointerId) &gt;= 0) {</span><span class="s3">\n          </span><span class="s1">this.finish();</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">break;</span><span class="s3">\n\n      </span><span class="s1">case EventTypes.UP:</span><span class="s3">\n        </span><span class="s1">if (this.isInProgress) {</span><span class="s3">\n          </span><span class="s1">this.finish();</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">break;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return true;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getTimeDelta(): number {</span><span class="s3">\n    </span><span class="s1">return this.currentTime + this.previousTime;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getAnchorX(): number {</span><span class="s3">\n    </span><span class="s1">return this.anchorX;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getAnchorY(): number {</span><span class="s3">\n    </span><span class="s1">return this.anchorY;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public getRotation(): number {</span><span class="s3">\n    </span><span class="s1">return this.rotation;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">public reset(): void {</span><span class="s3">\n    </span><span class="s1">this.keyPointers = [NaN, NaN];</span><span class="s3">\n    </span><span class="s1">this.isInProgress = false;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">]}</span></pre>
</body>
</html>