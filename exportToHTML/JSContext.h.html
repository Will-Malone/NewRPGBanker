<html>
<head>
<title>JSContext.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #bbb529;}
.s3 { color: #6a8759;}
.s4 { color: #cc7832;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
JSContext.h</font>
</center></td></tr></table>
<pre><span class="s0">/* 
 * Copyright (C) 2013-2019 Apple Inc. All rights reserved. 
 * 
 * Redistribution and use in source and binary forms, with or without 
 * modification, are permitted provided that the following conditions 
 * are met: 
 * 1. Redistributions of source code must retain the above copyright 
 *    notice, this list of conditions and the following disclaimer. 
 * 2. Redistributions in binary form must reproduce the above copyright 
 *    notice, this list of conditions and the following disclaimer in the 
 *    documentation and/or other materials provided with the distribution. 
 * 
 * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY 
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR 
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, 
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR 
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY 
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT 
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE 
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
 */</span>

<span class="s2">#ifndef </span><span class="s1">JSContext_h</span>
<span class="s2">#define </span><span class="s1">JSContext_h</span>

<span class="s2">#include </span><span class="s3">&lt;JavaScriptCore/JavaScript.h&gt;</span>
<span class="s2">#include </span><span class="s3">&lt;JavaScriptCore/WebKitAvailability.h&gt;</span>

<span class="s2">#if </span><span class="s1">JSC_OBJC_API_ENABLED</span>

<span class="s4">@class </span><span class="s1">JSScript</span><span class="s4">, </span><span class="s1">JSVirtualMachine</span><span class="s4">, </span><span class="s1">JSValue</span><span class="s4">, </span><span class="s1">JSContext</span><span class="s4">;</span>

<span class="s0">/*! 
@interface 
@discussion A JSContext is a JavaScript execution environment. All 
 JavaScript execution takes place within a context, and all JavaScript values 
 are tied to a context. 
*/</span>
<span class="s1">JSC_CLASS_AVAILABLE(macos(</span><span class="s5">10.9</span><span class="s1">)</span><span class="s4">, </span><span class="s1">ios(</span><span class="s5">7.0</span><span class="s1">))</span>
<span class="s4">@interface </span><span class="s1">JSContext : NSObject</span>

<span class="s0">/*! 
@methodgroup Creating New JSContexts 
*/</span>
<span class="s0">/*! 
@method 
@abstract Create a JSContext. 
@result The new context. 
*/</span>
<span class="s1">- (instancetype)init</span><span class="s4">;</span>

<span class="s0">/*! 
@method 
@abstract Create a JSContext in the specified virtual machine. 
@param virtualMachine The JSVirtualMachine in which the context will be created. 
@result The new context. 
*/</span>
<span class="s1">- (instancetype)initWithVirtualMachine:(JSVirtualMachine *)virtualMachine</span><span class="s4">;</span>

<span class="s0">/*! 
@methodgroup Evaluating Scripts 
*/</span>
<span class="s0">/*! 
@method 
@abstract Evaluate a string of JavaScript code. 
@param script A string containing the JavaScript code to evaluate. 
@result The last value generated by the script. 
*/</span>
<span class="s1">- (JSValue *)evaluateScript:(NSString *)script</span><span class="s4">;</span>

<span class="s0">/*! 
@method 
@abstract Evaluate a string of JavaScript code, with a URL for the script's source file. 
@param script A string containing the JavaScript code to evaluate. 
@param sourceURL A URL for the script's source file. Used by debuggers and when reporting exceptions. This parameter is informative only: it does not change the behavior of the script. 
@result The last value generated by the script. 
*/</span>
<span class="s1">- (JSValue *)evaluateScript:(NSString *)script withSourceURL:(NSURL *)sourceURL JSC_API_AVAILABLE(macos(</span><span class="s5">10.10</span><span class="s1">)</span><span class="s4">, </span><span class="s1">ios(</span><span class="s5">8.0</span><span class="s1">))</span><span class="s4">;</span>

<span class="s0">/*! 
@methodgroup Callback Accessors 
*/</span>
<span class="s0">/*! 
@method 
@abstract Get the JSContext that is currently executing. 
@discussion This method may be called from within an Objective-C block or method invoked 
 as a callback from JavaScript to retrieve the callback's context. Outside of 
 a callback from JavaScript this method will return nil. 
@result The currently executing JSContext or nil if there isn't one. 
*/</span>
<span class="s1">+ (JSContext *)currentContext</span><span class="s4">;</span>

<span class="s0">/*! 
@method 
@abstract Get the JavaScript function that is currently executing. 
@discussion This method may be called from within an Objective-C block or method invoked 
 as a callback from JavaScript to retrieve the callback's context. Outside of 
 a callback from JavaScript this method will return nil. 
@result The currently executing JavaScript function or nil if there isn't one. 
*/</span>
<span class="s1">+ (JSValue *)currentCallee JSC_API_AVAILABLE(macos(</span><span class="s5">10.10</span><span class="s1">)</span><span class="s4">, </span><span class="s1">ios(</span><span class="s5">8.0</span><span class="s1">))</span><span class="s4">;</span>

<span class="s0">/*! 
@method 
@abstract Get the &lt;code&gt;this&lt;/code&gt; value of the currently executing method. 
@discussion This method may be called from within an Objective-C block or method invoked 
 as a callback from JavaScript to retrieve the callback's this value. Outside 
 of a callback from JavaScript this method will return nil. 
@result The current &lt;code&gt;this&lt;/code&gt; value or nil if there isn't one. 
*/</span>
<span class="s1">+ (JSValue *)currentThis</span><span class="s4">;</span>

<span class="s0">/*! 
@method 
@abstract Get the arguments to the current callback. 
@discussion This method may be called from within an Objective-C block or method invoked 
 as a callback from JavaScript to retrieve the callback's arguments, objects 
 in the returned array are instances of JSValue. Outside of a callback from 
 JavaScript this method will return nil. 
@result An NSArray of the arguments nil if there is no current callback. 
*/</span>
<span class="s1">+ (NSArray *)currentArguments</span><span class="s4">;</span>

<span class="s0">/*! 
@functiongroup Global Properties 
*/</span>

<span class="s0">/*! 
@property 
@abstract Get the global object of the context. 
@discussion This method retrieves the global object of the JavaScript execution context. 
 Instances of JSContext originating from WebKit will return a reference to the 
 WindowProxy object. 
@result The global object. 
*/</span>
<span class="s4">@property </span><span class="s1">(readonly</span><span class="s4">, </span><span class="s1">strong) JSValue *globalObject</span><span class="s4">;</span>

<span class="s0">/*! 
@property 
@discussion The &lt;code&gt;exception&lt;/code&gt; property may be used to throw an exception to JavaScript. 
  
 Before a callback is made from JavaScript to an Objective-C block or method, 
 the prior value of the exception property will be preserved and the property 
 will be set to nil. After the callback has completed the new value of the 
 exception property will be read, and prior value restored. If the new value 
 of exception is not nil, the callback will result in that value being thrown. 
  
 This property may also be used to check for uncaught exceptions arising from 
 API function calls (since the default behaviour of &lt;code&gt;exceptionHandler&lt;/code&gt; is to 
 assign an uncaught exception to this property). 
*/</span>
<span class="s4">@property </span><span class="s1">(strong) JSValue *exception</span><span class="s4">;</span>

<span class="s0">/*! 
@property 
@discussion If a call to an API function results in an uncaught JavaScript exception, the 
 &lt;code&gt;exceptionHandler&lt;/code&gt; block will be invoked. The default implementation for the 
 exception handler will store the exception to the exception property on 
 context. As a consequence the default behaviour is for uncaught exceptions 
 occurring within a callback from JavaScript to be rethrown upon return. 
 Setting this value to nil will cause all exceptions occurring 
 within a callback from JavaScript to be silently caught. 
*/</span>
<span class="s4">@property </span><span class="s1">(copy) </span><span class="s4">void</span><span class="s1">(^exceptionHandler)(JSContext *context</span><span class="s4">, </span><span class="s1">JSValue *exception)</span><span class="s4">;</span>

<span class="s0">/*! 
@property 
@discussion All instances of JSContext are associated with a JSVirtualMachine. 
*/</span>
<span class="s4">@property </span><span class="s1">(readonly</span><span class="s4">, </span><span class="s1">strong) JSVirtualMachine *virtualMachine</span><span class="s4">;</span>

<span class="s0">/*! 
@property 
@discussion Name of the JSContext. Exposed when remote debugging the context. 
*/</span>
<span class="s4">@property </span><span class="s1">(copy) NSString *name JSC_API_AVAILABLE(macos(</span><span class="s5">10.10</span><span class="s1">)</span><span class="s4">, </span><span class="s1">ios(</span><span class="s5">8.0</span><span class="s1">))</span><span class="s4">;</span>
<span class="s4">@end</span>

<span class="s0">/*! 
@category 
@discussion Instances of JSContext implement the following methods in order to enable 
 support for subscript access by key and index, for example: 
 
@textblock 
    JSContext *context; 
    JSValue *v = context[@&quot;X&quot;]; // Get value for &quot;X&quot; from the global object. 
    context[@&quot;Y&quot;] = v;          // Assign 'v' to &quot;Y&quot; on the global object. 
@/textblock 
 
 An object key passed as a subscript will be converted to a JavaScript value, 
 and then the value converted to a string used to resolve a property of the 
 global object. 
*/</span>
<span class="s4">@interface </span><span class="s1">JSContext (SubscriptSupport)</span>

<span class="s0">/*! 
@method 
@abstract Get a particular property on the global object. 
@result The JSValue for the global object's property. 
*/</span>
<span class="s1">- (JSValue *)objectForKeyedSubscript:(id)key</span><span class="s4">;</span>

<span class="s0">/*! 
@method 
@abstract Set a particular property on the global object. 
*/</span>
<span class="s1">- (</span><span class="s4">void</span><span class="s1">)setObject:(id)object forKeyedSubscript:(NSObject &lt;NSCopying&gt; *)key</span><span class="s4">;</span>

<span class="s4">@end</span>

<span class="s0">/*! 
@category 
@discussion These functions are for bridging between the C API and the Objective-C API. 
*/</span>
<span class="s4">@interface </span><span class="s1">JSContext (JSContextRefSupport)</span>

<span class="s0">/*! 
@method 
@abstract Create a JSContext, wrapping its C API counterpart. 
@result The JSContext equivalent of the provided JSGlobalContextRef. 
*/</span>
<span class="s1">+ (JSContext *)contextWithJSGlobalContextRef:(JSGlobalContextRef)jsGlobalContextRef</span><span class="s4">;</span>

<span class="s0">/*! 
@property 
@abstract Get the C API counterpart wrapped by a JSContext. 
@result The C API equivalent of this JSContext. 
*/</span>
<span class="s4">@property </span><span class="s1">(readonly) JSGlobalContextRef JSGlobalContextRef</span><span class="s4">;</span>

<span class="s4">@end</span>

<span class="s2">#endif</span>

<span class="s2">#endif </span><span class="s0">// JSContext_h</span>
</pre>
</body>
</html>