<html>
<head>
<title>gestureComposition.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #6a8759;}
.s2 { color: #6897bb; font-style: italic;}
.s3 { color: #cc7832; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
gestureComposition.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;gestureComposition.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;extendRelation&quot;</span><span class="s0">,</span><span class="s1">&quot;currentRelation&quot;</span><span class="s0">,</span><span class="s1">&quot;extendWith&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;ComposedGesture&quot;</span><span class="s0">,</span><span class="s1">&quot;Gesture&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;gestures&quot;</span><span class="s0">,</span><span class="s1">&quot;prepareSingleGesture&quot;</span><span class="s0">,</span><span class="s1">&quot;gesture&quot;</span><span class="s0">,</span><span class="s1">&quot;simultaneousGestures&quot;</span><span class="s0">,</span><span class="s1">&quot;requireGesturesToFail&quot;</span><span class="s0">,</span><span class="s1">&quot;BaseGesture&quot;</span><span class="s0">,</span><span class="s1">&quot;newConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;config&quot;</span><span class="s0">,</span><span class="s1">&quot;simultaneousWith&quot;</span><span class="s0">,</span><span class="s1">&quot;requireToFail&quot;</span><span class="s0">,</span><span class="s1">&quot;prepare&quot;</span><span class="s0">,</span><span class="s1">&quot;initialize&quot;</span><span class="s0">,</span><span class="s1">&quot;toGestureArray&quot;</span><span class="s0">,</span><span class="s1">&quot;flatMap&quot;</span><span class="s0">,</span><span class="s1">&quot;SimultaneousGesture&quot;</span><span class="s0">,</span><span class="s1">&quot;simultaneousArrays&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;x&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;ExclusiveGesture&quot;</span><span class="s0">,</span><span class="s1">&quot;gestureArrays&quot;</span><span class="s0">,</span><span class="s1">&quot;concat&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">,</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import { BaseGesture, Gesture, GestureRef, GestureType } from './gesture';</span><span class="s3">\n\n</span><span class="s1">function extendRelation(</span><span class="s3">\n  </span><span class="s1">currentRelation: GestureRef[] | undefined,</span><span class="s3">\n  </span><span class="s1">extendWith: GestureType[]</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (currentRelation === undefined) {</span><span class="s3">\n    </span><span class="s1">return [...extendWith];</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">return [...currentRelation, ...extendWith];</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class ComposedGesture extends Gesture {</span><span class="s3">\n  </span><span class="s1">protected gestures: Gesture[] = [];</span><span class="s3">\n  </span><span class="s1">protected simultaneousGestures: GestureType[] = [];</span><span class="s3">\n  </span><span class="s1">protected requireGesturesToFail: GestureType[] = [];</span><span class="s3">\n\n  </span><span class="s1">constructor(...gestures: Gesture[]) {</span><span class="s3">\n    </span><span class="s1">super();</span><span class="s3">\n    </span><span class="s1">this.gestures = gestures;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">protected prepareSingleGesture(</span><span class="s3">\n    </span><span class="s1">gesture: Gesture,</span><span class="s3">\n    </span><span class="s1">simultaneousGestures: GestureType[],</span><span class="s3">\n    </span><span class="s1">requireGesturesToFail: GestureType[]</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">if (gesture instanceof BaseGesture) {</span><span class="s3">\n      </span><span class="s1">const newConfig = { ...gesture.config };</span><span class="s3">\n\n      </span><span class="s1">newConfig.simultaneousWith = extendRelation(</span><span class="s3">\n        </span><span class="s1">newConfig.simultaneousWith,</span><span class="s3">\n        </span><span class="s1">simultaneousGestures</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">newConfig.requireToFail = extendRelation(</span><span class="s3">\n        </span><span class="s1">newConfig.requireToFail,</span><span class="s3">\n        </span><span class="s1">requireGesturesToFail</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n\n      </span><span class="s1">gesture.config = newConfig;</span><span class="s3">\n    </span><span class="s1">} else if (gesture instanceof ComposedGesture) {</span><span class="s3">\n      </span><span class="s1">gesture.simultaneousGestures = simultaneousGestures;</span><span class="s3">\n      </span><span class="s1">gesture.requireGesturesToFail = requireGesturesToFail;</span><span class="s3">\n      </span><span class="s1">gesture.prepare();</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">prepare() {</span><span class="s3">\n    </span><span class="s1">for (const gesture of this.gestures) {</span><span class="s3">\n      </span><span class="s1">this.prepareSingleGesture(</span><span class="s3">\n        </span><span class="s1">gesture,</span><span class="s3">\n        </span><span class="s1">this.simultaneousGestures,</span><span class="s3">\n        </span><span class="s1">this.requireGesturesToFail</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">initialize() {</span><span class="s3">\n    </span><span class="s1">for (const gesture of this.gestures) {</span><span class="s3">\n      </span><span class="s1">gesture.initialize();</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">toGestureArray(): GestureType[] {</span><span class="s3">\n    </span><span class="s1">return this.gestures.flatMap((gesture) =&gt; gesture.toGestureArray());</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class SimultaneousGesture extends ComposedGesture {</span><span class="s3">\n  </span><span class="s1">prepare() {</span><span class="s3">\n    </span><span class="s1">// this piece of magic works something like this:</span><span class="s3">\n    </span><span class="s1">// for every gesture in the array</span><span class="s3">\n    </span><span class="s1">const simultaneousArrays = this.gestures.map((gesture) =&gt;</span><span class="s3">\n      </span><span class="s1">// we take the array it's in</span><span class="s3">\n      </span><span class="s1">this.gestures</span><span class="s3">\n        </span><span class="s1">// and make a copy without it</span><span class="s3">\n        </span><span class="s1">.filter((x) =&gt; x !== gesture)</span><span class="s3">\n        </span><span class="s1">// then we flatmap the result to get list of raw (not composed) gestures</span><span class="s3">\n        </span><span class="s1">// this way we don't make the gestures simultaneous with themselves, which is</span><span class="s3">\n        </span><span class="s1">// important when the gesture is `ExclusiveGesture` - we don't want to make</span><span class="s3">\n        </span><span class="s1">// exclusive gestures simultaneous</span><span class="s3">\n        </span><span class="s1">.flatMap((x) =&gt; x.toGestureArray())</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n\n    </span><span class="s1">for (let i = 0; i &lt; this.gestures.length; i++) {</span><span class="s3">\n      </span><span class="s1">this.prepareSingleGesture(</span><span class="s3">\n        </span><span class="s1">this.gestures[i],</span><span class="s3">\n        </span><span class="s1">simultaneousArrays[i],</span><span class="s3">\n        </span><span class="s1">this.requireGesturesToFail</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export class ExclusiveGesture extends ComposedGesture {</span><span class="s3">\n  </span><span class="s1">prepare() {</span><span class="s3">\n    </span><span class="s1">// transforms the array of gestures into array of grouped raw (not composed) gestures</span><span class="s3">\n    </span><span class="s1">// i.e. [gesture1, gesture2, ComposedGesture(gesture3, gesture4)] -&gt; [[gesture1], [gesture2], [gesture3, gesture4]]</span><span class="s3">\n    </span><span class="s1">const gestureArrays = this.gestures.map((gesture) =&gt;</span><span class="s3">\n      </span><span class="s1">gesture.toGestureArray()</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n\n    </span><span class="s1">let requireToFail: GestureType[] = [];</span><span class="s3">\n\n    </span><span class="s1">for (let i = 0; i &lt; this.gestures.length; i++) {</span><span class="s3">\n      </span><span class="s1">this.prepareSingleGesture(</span><span class="s3">\n        </span><span class="s1">this.gestures[i],</span><span class="s3">\n        </span><span class="s1">this.simultaneousGestures,</span><span class="s3">\n        </span><span class="s1">this.requireGesturesToFail.concat(requireToFail)</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n\n      </span><span class="s1">// every group gets to wait for all groups before it</span><span class="s3">\n      </span><span class="s1">requireToFail = requireToFail.concat(gestureArrays[i]);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export type ComposedGestureType = InstanceType&lt;typeof ComposedGesture&gt;;</span><span class="s3">\n</span><span class="s1">export type RaceGestureType = ComposedGestureType;</span><span class="s3">\n</span><span class="s1">export type SimultaneousGestureType = InstanceType&lt;typeof SimultaneousGesture&gt;;</span><span class="s3">\n</span><span class="s1">export type ExclusiveGestureType = InstanceType&lt;typeof ExclusiveGesture&gt;;</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">]}</span></pre>
</body>
</html>