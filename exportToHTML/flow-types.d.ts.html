<html>
<head>
<title>flow-types.d.ts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #cc7832;}
.s2 { color: #a9b7c6;}
.s3 { color: #a9b7c6;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb; font-style: italic;}
.s6 { color: #cc7832; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
flow-types.d.ts</font>
</center></td></tr></table>
<pre><span class="s0">/**</span>
 <span class="s0">* Copyright (c) Meta Platforms, Inc. and affiliates. 
 * 
 * This source code is licensed under the MIT license found in the 
 * LICENSE file in the root directory of this source tree. 
 * 
 * </span><span class="s1">@format</span>
 <span class="s0">* </span><span class="s1">@oncall </span><span class="s0">react_native 
 */</span>

<span class="s1">import type </span><span class="s3">ModuleMap </span><span class="s1">from </span><span class="s4">'./ModuleMap'</span><span class="s2">;</span>
<span class="s1">import type </span><span class="s2">{</span><span class="s3">PerfLoggerFactory</span><span class="s2">, </span><span class="s3">RootPerfLogger</span><span class="s2">, </span><span class="s3">PerfLogger</span><span class="s2">} </span><span class="s1">from </span><span class="s4">'metro-config'</span><span class="s2">;</span>
<span class="s1">import type </span><span class="s2">{</span><span class="s3">AbortSignal</span><span class="s2">} </span><span class="s1">from </span><span class="s4">'node-abort-controller'</span><span class="s2">;</span>

<span class="s1">export type </span><span class="s2">{</span><span class="s3">PerfLoggerFactory</span><span class="s2">, </span><span class="s3">PerfLogger</span><span class="s2">};</span>

<span class="s0">/**</span>
 <span class="s0">* These inputs affect the internal data collected for a given filesystem 
 * state, and changes may invalidate a cache. 
 */</span>
<span class="s1">export type </span><span class="s3">BuildParameters </span><span class="s1">= </span><span class="s3">Readonly</span><span class="s2">&lt;{</span>
  <span class="s2">computeDependencies</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">computeSha1</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">enableSymlinks</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">extensions</span><span class="s1">: </span><span class="s3">ReadonlyArray</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">&gt;;</span>
  <span class="s2">forceNodeFilesystemAPI</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">ignorePattern</span><span class="s1">: </span><span class="s3">RegExp</span><span class="s2">;</span>
  <span class="s2">mocksPattern</span><span class="s1">: </span><span class="s3">RegExp </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">platforms</span><span class="s1">: </span><span class="s3">ReadonlyArray</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">&gt;;</span>
  <span class="s2">retainAllFiles</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">rootDir</span><span class="s1">: </span><span class="s3">string</span><span class="s2">;</span>
  <span class="s2">roots</span><span class="s1">: </span><span class="s3">ReadonlyArray</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">&gt;;</span>
  <span class="s2">skipPackageJson</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">dependencyExtractor</span><span class="s1">: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">hasteImplModulePath</span><span class="s1">: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">cacheBreaker</span><span class="s1">: </span><span class="s3">string</span><span class="s2">;</span>
<span class="s2">}&gt;;</span>

<span class="s1">export interface </span><span class="s3">BuildResult </span><span class="s2">{</span>
  <span class="s2">fileSystem</span><span class="s1">: </span><span class="s3">FileSystem</span><span class="s2">;</span>
  <span class="s2">hasteModuleMap</span><span class="s1">: </span><span class="s3">ModuleMap</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export interface </span><span class="s3">CacheData </span><span class="s2">{</span>
  <span class="s1">readonly </span><span class="s2">clocks</span><span class="s1">: </span><span class="s3">WatchmanClocks</span><span class="s2">;</span>
  <span class="s1">readonly </span><span class="s2">map</span><span class="s1">: </span><span class="s3">RawModuleMap</span><span class="s2">[</span><span class="s4">'map'</span><span class="s2">];</span>
  <span class="s1">readonly </span><span class="s2">mocks</span><span class="s1">: </span><span class="s3">RawModuleMap</span><span class="s2">[</span><span class="s4">'mocks'</span><span class="s2">];</span>
  <span class="s1">readonly </span><span class="s2">duplicates</span><span class="s1">: </span><span class="s3">RawModuleMap</span><span class="s2">[</span><span class="s4">'duplicates'</span><span class="s2">];</span>
  <span class="s1">readonly </span><span class="s2">files</span><span class="s1">: </span><span class="s3">FileData</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export interface </span><span class="s3">CacheManager </span><span class="s2">{</span>
  <span class="s2">read()</span><span class="s1">: </span><span class="s3">Promise</span><span class="s2">&lt;</span><span class="s3">CacheData </span><span class="s1">| </span><span class="s3">null</span><span class="s2">&gt;;</span>
  <span class="s2">write(</span>
    <span class="s3">dataSnapshot</span><span class="s1">: </span><span class="s3">CacheData</span><span class="s2">,</span>
    <span class="s3">delta</span><span class="s1">: </span><span class="s3">Readonly</span><span class="s2">&lt;{changed</span><span class="s1">: </span><span class="s3">FileData</span><span class="s2">; removed</span><span class="s1">: </span><span class="s3">FileData</span><span class="s2">}&gt;,</span>
  <span class="s2">)</span><span class="s1">: </span><span class="s3">Promise</span><span class="s2">&lt;</span><span class="s3">void</span><span class="s2">&gt;;</span>
<span class="s2">}</span>

<span class="s1">export type </span><span class="s3">CacheManagerFactory </span><span class="s1">= </span><span class="s2">(</span>
  <span class="s3">buildParameters</span><span class="s1">: </span><span class="s3">BuildParameters</span><span class="s2">,</span>
<span class="s2">) </span><span class="s1">=&gt; </span><span class="s3">CacheManager</span><span class="s2">;</span>

<span class="s1">export interface </span><span class="s3">ChangeEvent </span><span class="s2">{</span>
  <span class="s2">logger</span><span class="s1">: </span><span class="s3">RootPerfLogger </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">eventsQueue</span><span class="s1">: </span><span class="s3">EventsQueue</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export interface </span><span class="s3">ChangeEventMetadata </span><span class="s2">{</span>
  <span class="s0">/** Epoch ms */</span>
  <span class="s2">modifiedTime</span><span class="s1">: </span><span class="s3">number </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s0">/** Bytes */</span>
  <span class="s2">size</span><span class="s1">: </span><span class="s3">number </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s0">/** Regular file / Directory / Symlink */</span>
  <span class="s2">type</span><span class="s1">: </span><span class="s4">'f' </span><span class="s1">| </span><span class="s4">'d' </span><span class="s1">| </span><span class="s4">'l'</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export type </span><span class="s3">Console </span><span class="s1">= typeof </span><span class="s3">global</span><span class="s2">.</span><span class="s3">console</span><span class="s2">;</span>

<span class="s1">export interface </span><span class="s3">CrawlerOptions </span><span class="s2">{</span>
  <span class="s2">abortSignal</span><span class="s1">: </span><span class="s3">AbortSignal </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">computeSha1</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">extensions</span><span class="s1">: </span><span class="s3">ReadonlyArray</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">&gt;;</span>
  <span class="s2">forceNodeFilesystemAPI</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">ignore</span><span class="s1">: </span><span class="s3">IgnoreMatcher</span><span class="s2">;</span>
  <span class="s2">includeSymlinks</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">perfLogger</span><span class="s1">?: </span><span class="s3">PerfLogger </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">previousState</span><span class="s1">: </span><span class="s3">Readonly</span><span class="s2">&lt;{</span>
    <span class="s2">clocks</span><span class="s1">: </span><span class="s3">ReadonlyMap</span><span class="s2">&lt;</span><span class="s3">Path</span><span class="s2">, </span><span class="s3">WatchmanClockSpec</span><span class="s2">&gt;;</span>
    <span class="s2">files</span><span class="s1">: </span><span class="s3">ReadonlyMap</span><span class="s2">&lt;</span><span class="s3">Path</span><span class="s2">, </span><span class="s3">FileMetaData</span><span class="s2">&gt;;</span>
  <span class="s2">}&gt;;</span>
  <span class="s2">rootDir</span><span class="s1">: </span><span class="s3">string</span><span class="s2">;</span>
  <span class="s2">roots</span><span class="s1">: </span><span class="s3">ReadonlyArray</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">&gt;;</span>
  <span class="s2">onStatus</span><span class="s1">: </span><span class="s2">(</span><span class="s3">status</span><span class="s1">: </span><span class="s3">WatcherStatus</span><span class="s2">) </span><span class="s1">=&gt; </span><span class="s3">void</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export type </span><span class="s3">WatcherStatus </span><span class="s1">=</span>
  <span class="s1">| </span><span class="s2">{</span>
      <span class="s2">type</span><span class="s1">: </span><span class="s4">'watchman_slow_command'</span><span class="s2">;</span>
      <span class="s2">timeElapsed</span><span class="s1">: </span><span class="s3">number</span><span class="s2">;</span>
      <span class="s2">command</span><span class="s1">: </span><span class="s4">'watch-project' </span><span class="s1">| </span><span class="s4">'query'</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s1">| </span><span class="s2">{</span>
      <span class="s2">type</span><span class="s1">: </span><span class="s4">'watchman_slow_command_complete'</span><span class="s2">;</span>
      <span class="s2">timeElapsed</span><span class="s1">: </span><span class="s3">number</span><span class="s2">;</span>
      <span class="s2">command</span><span class="s1">: </span><span class="s4">'watch-project' </span><span class="s1">| </span><span class="s4">'query'</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s1">| </span><span class="s2">{</span>
      <span class="s2">type</span><span class="s1">: </span><span class="s4">'watchman_warning'</span><span class="s2">;</span>
      <span class="s2">warning</span><span class="s1">: </span><span class="s3">unknown</span><span class="s2">;</span>
      <span class="s2">command</span><span class="s1">: </span><span class="s4">'watch-project' </span><span class="s1">| </span><span class="s4">'query'</span><span class="s2">;</span>
    <span class="s2">};</span>

<span class="s1">export type </span><span class="s3">DuplicatesSet </span><span class="s1">= </span><span class="s3">Map</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s0">/* type */ </span><span class="s3">number</span><span class="s2">&gt;;</span>
<span class="s1">export type </span><span class="s3">DuplicatesIndex </span><span class="s1">= </span><span class="s3">Map</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">Map</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">DuplicatesSet</span><span class="s2">&gt;&gt;;</span>

<span class="s1">export type </span><span class="s3">EventsQueue </span><span class="s1">= </span><span class="s3">Array</span><span class="s2">&lt;{</span>
  <span class="s2">filePath</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">;</span>
  <span class="s2">metadata</span><span class="s1">?: </span><span class="s3">ChangeEventMetadata </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">type</span><span class="s1">: </span><span class="s3">string</span><span class="s2">;</span>
<span class="s2">}&gt;;</span>

<span class="s1">export interface </span><span class="s3">HType </span><span class="s2">{</span>
  <span class="s2">ID</span><span class="s1">: </span><span class="s5">0</span><span class="s2">;</span>
  <span class="s2">MTIME</span><span class="s1">: </span><span class="s5">1</span><span class="s2">;</span>
  <span class="s2">SIZE</span><span class="s1">: </span><span class="s5">2</span><span class="s2">;</span>
  <span class="s2">VISITED</span><span class="s1">: </span><span class="s5">3</span><span class="s2">;</span>
  <span class="s2">DEPENDENCIES</span><span class="s1">: </span><span class="s5">4</span><span class="s2">;</span>
  <span class="s2">SHA1</span><span class="s1">: </span><span class="s5">5</span><span class="s2">;</span>
  <span class="s2">SYMLINK</span><span class="s1">: </span><span class="s5">6</span><span class="s2">;</span>
  <span class="s2">PATH</span><span class="s1">: </span><span class="s5">0</span><span class="s2">;</span>
  <span class="s2">TYPE</span><span class="s1">: </span><span class="s5">1</span><span class="s2">;</span>
  <span class="s2">MODULE</span><span class="s1">: </span><span class="s5">0</span><span class="s2">;</span>
  <span class="s2">PACKAGE</span><span class="s1">: </span><span class="s5">1</span><span class="s2">;</span>
  <span class="s2">GENERIC_PLATFORM</span><span class="s1">: </span><span class="s4">'g'</span><span class="s2">;</span>
  <span class="s2">NATIVE_PLATFORM</span><span class="s1">: </span><span class="s4">'native'</span><span class="s2">;</span>
  <span class="s2">DEPENDENCY_DELIM</span><span class="s1">: </span><span class="s4">'</span><span class="s6">\0</span><span class="s4">'</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">type </span><span class="s3">Values</span><span class="s2">&lt;</span><span class="s3">T</span><span class="s2">&gt; </span><span class="s1">= </span><span class="s3">T</span><span class="s2">[</span><span class="s1">keyof </span><span class="s3">T</span><span class="s2">];</span>
<span class="s1">export type </span><span class="s3">HTypeValue </span><span class="s1">= </span><span class="s3">Values</span><span class="s2">&lt;</span><span class="s3">HType</span><span class="s2">&gt;;</span>

<span class="s1">export type </span><span class="s3">IgnoreMatcher </span><span class="s1">= </span><span class="s2">(</span><span class="s3">item</span><span class="s1">: </span><span class="s3">string</span><span class="s2">) </span><span class="s1">=&gt; </span><span class="s3">boolean</span><span class="s2">;</span>

<span class="s1">export type </span><span class="s3">FileData </span><span class="s1">= </span><span class="s3">Map</span><span class="s2">&lt;</span><span class="s3">Path</span><span class="s2">, </span><span class="s3">FileMetaData</span><span class="s2">&gt;;</span>

<span class="s1">export type </span><span class="s3">FileMetaData </span><span class="s1">= </span><span class="s2">[</span>
  <span class="s0">/* id */ </span><span class="s3">string</span><span class="s2">,</span>
  <span class="s0">/* mtime */ </span><span class="s3">number</span><span class="s2">,</span>
  <span class="s0">/* size */ </span><span class="s3">number</span><span class="s2">,</span>
  <span class="s0">/* visited */ </span><span class="s5">0 </span><span class="s1">| </span><span class="s5">1</span><span class="s2">,</span>
  <span class="s0">/* dependencies */ </span><span class="s3">string</span><span class="s2">,</span>
  <span class="s0">/* sha1 */ </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">,</span>
  <span class="s0">/* symlink */ </span><span class="s5">0 </span><span class="s1">| </span><span class="s5">1 </span><span class="s1">| </span><span class="s3">string</span><span class="s2">, </span><span class="s0">// string specifies target, if known</span>
<span class="s2">];</span>

<span class="s1">export type </span><span class="s3">FileStats </span><span class="s1">= </span><span class="s3">Readonly</span><span class="s2">&lt;{</span>
  <span class="s2">fileType</span><span class="s1">: </span><span class="s4">'f' </span><span class="s1">| </span><span class="s4">'l'</span><span class="s2">;</span>
  <span class="s2">modifiedTime</span><span class="s1">: </span><span class="s3">number</span><span class="s2">;</span>
<span class="s2">}&gt;;</span>

<span class="s1">export interface </span><span class="s3">FileSystem </span><span class="s2">{</span>
  <span class="s2">exists(</span><span class="s3">file</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">)</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">getAllFiles()</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">[];</span>
  <span class="s2">getDependencies(</span><span class="s3">file</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">)</span><span class="s1">: </span><span class="s3">string</span><span class="s2">[] </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">getModuleName(</span><span class="s3">file</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">)</span><span class="s1">: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">getRealPath(</span><span class="s3">file</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">)</span><span class="s1">: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">getSerializableSnapshot()</span><span class="s1">: </span><span class="s3">FileData</span><span class="s2">;</span>
  <span class="s2">getSha1(</span><span class="s3">file</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">)</span><span class="s1">: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>

  <span class="s0">/**</span>
   <span class="s0">* Analogous to posix lstat. If the file at `file` is a symlink, return 
   * information about the symlink without following it. 
   */</span>
  <span class="s2">linkStats(</span><span class="s3">file</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">)</span><span class="s1">: </span><span class="s3">FileStats </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>

  <span class="s2">matchFiles(</span><span class="s3">pattern</span><span class="s1">: </span><span class="s3">RegExp </span><span class="s1">| </span><span class="s3">string</span><span class="s2">)</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">[];</span>

  <span class="s0">/**</span>
   <span class="s0">* Given a search context, return a list of file paths matching the query. 
   * The query matches against normalized paths which start with `./`, 
   * for example: `a/b.js` -&gt; `./a/b.js` 
   */</span>
  <span class="s2">matchFilesWithContext(</span>
    <span class="s3">root</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">,</span>
    <span class="s3">context</span><span class="s1">: </span><span class="s3">Readonly</span><span class="s2">&lt;{</span>
      <span class="s0">/* Should search for files recursively. */</span>
      <span class="s2">recursive</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
      <span class="s0">/* Filter relative paths against a pattern. */</span>
      <span class="s2">filter</span><span class="s1">: </span><span class="s3">RegExp</span><span class="s2">;</span>
    <span class="s2">}&gt;,</span>
  <span class="s2">)</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">[];</span>
<span class="s2">}</span>

<span class="s1">export type </span><span class="s3">Glob </span><span class="s1">= </span><span class="s3">string</span><span class="s2">;</span>

<span class="s0">// tslint:disable-next-line interface-name</span>
<span class="s1">export interface </span><span class="s3">IModuleMap </span><span class="s2">{</span>
  <span class="s2">getModule(</span>
    <span class="s3">name</span><span class="s1">: </span><span class="s3">string</span><span class="s2">,</span>
    <span class="s3">platform</span><span class="s1">?: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">,</span>
    <span class="s3">supportsNativePlatform</span><span class="s1">?: </span><span class="s3">boolean </span><span class="s1">| </span><span class="s3">null</span><span class="s2">,</span>
    <span class="s3">type</span><span class="s1">?: </span><span class="s3">HTypeValue </span><span class="s1">| </span><span class="s3">null</span><span class="s2">,</span>
  <span class="s2">)</span><span class="s1">: </span><span class="s3">Path </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>

  <span class="s2">getPackage(</span>
    <span class="s3">name</span><span class="s1">: </span><span class="s3">string</span><span class="s2">,</span>
    <span class="s3">platform</span><span class="s1">: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">,</span>
    <span class="s3">_supportsNativePlatform</span><span class="s1">: </span><span class="s3">boolean </span><span class="s1">| </span><span class="s3">null</span><span class="s2">,</span>
  <span class="s2">)</span><span class="s1">: </span><span class="s3">Path </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>

  <span class="s2">getMockModule(</span><span class="s3">name</span><span class="s1">: </span><span class="s3">string</span><span class="s2">)</span><span class="s1">: </span><span class="s3">Path </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>

  <span class="s2">getRawModuleMap()</span><span class="s1">: </span><span class="s3">ReadOnlyRawModuleMap</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export type </span><span class="s3">MockData </span><span class="s1">= </span><span class="s3">Map</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">Path</span><span class="s2">&gt;;</span>
<span class="s1">export type </span><span class="s3">ModuleMapData </span><span class="s1">= </span><span class="s3">Map</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">ModuleMapItem</span><span class="s2">&gt;;</span>

<span class="s1">export interface </span><span class="s3">ModuleMapItem </span><span class="s2">{</span>
  <span class="s2">[</span><span class="s3">platform</span><span class="s1">: </span><span class="s3">string</span><span class="s2">]</span><span class="s1">: </span><span class="s3">ModuleMetaData</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="s1">export type </span><span class="s3">ModuleMetaData </span><span class="s1">= </span><span class="s2">[</span><span class="s0">/* path */ </span><span class="s3">string</span><span class="s2">, </span><span class="s0">/* type */ </span><span class="s3">number</span><span class="s2">];</span>

<span class="s1">export interface </span><span class="s3">MutableFileSystem </span><span class="s1">extends </span><span class="s3">FileSystem </span><span class="s2">{</span>
  <span class="s2">remove(</span><span class="s3">filePath</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">)</span><span class="s1">: </span><span class="s3">void</span><span class="s2">;</span>
  <span class="s2">addOrModify(</span><span class="s3">filePath</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">, </span><span class="s3">fileMetadata</span><span class="s1">: </span><span class="s3">FileMetaData</span><span class="s2">)</span><span class="s1">: </span><span class="s3">void</span><span class="s2">;</span>
  <span class="s2">bulkAddOrModify(</span><span class="s3">addedOrModifiedFiles</span><span class="s1">: </span><span class="s3">FileData</span><span class="s2">)</span><span class="s1">: </span><span class="s3">void</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export type </span><span class="s3">Path </span><span class="s1">= </span><span class="s3">string</span><span class="s2">;</span>

<span class="s1">export interface </span><span class="s3">RawModuleMap </span><span class="s2">{</span>
  <span class="s2">rootDir</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">;</span>
  <span class="s2">duplicates</span><span class="s1">: </span><span class="s3">DuplicatesIndex</span><span class="s2">;</span>
  <span class="s2">map</span><span class="s1">: </span><span class="s3">ModuleMapData</span><span class="s2">;</span>
  <span class="s2">mocks</span><span class="s1">: </span><span class="s3">MockData</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s1">export type </span><span class="s3">ReadOnlyRawModuleMap </span><span class="s1">= </span><span class="s3">Readonly</span><span class="s2">&lt;{</span>
  <span class="s2">rootDir</span><span class="s1">: </span><span class="s3">Path</span><span class="s2">;</span>
  <span class="s2">duplicates</span><span class="s1">: </span><span class="s3">ReadonlyMap</span><span class="s2">&lt;</span>
    <span class="s3">string</span><span class="s2">,</span>
    <span class="s3">ReadonlyMap</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">ReadonlyMap</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">number</span><span class="s2">&gt;&gt;</span>
  <span class="s2">&gt;;</span>
  <span class="s2">map</span><span class="s1">: </span><span class="s3">ReadonlyMap</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">ModuleMapItem</span><span class="s2">&gt;;</span>
  <span class="s2">mocks</span><span class="s1">: </span><span class="s3">ReadonlyMap</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">, </span><span class="s3">Path</span><span class="s2">&gt;;</span>
<span class="s2">}&gt;;</span>

<span class="s1">export type </span><span class="s3">WatchmanClockSpec </span><span class="s1">=</span>
  <span class="s1">| </span><span class="s3">string</span>
  <span class="s1">| </span><span class="s3">Readonly</span><span class="s2">&lt;{scm</span><span class="s1">: </span><span class="s3">Readonly</span><span class="s2">&lt;{</span><span class="s4">'mergebase-with'</span><span class="s1">: </span><span class="s3">string</span><span class="s2">}&gt;}&gt;;</span>
<span class="s1">export type </span><span class="s3">WatchmanClocks </span><span class="s1">= </span><span class="s3">Map</span><span class="s2">&lt;</span><span class="s3">Path</span><span class="s2">, </span><span class="s3">WatchmanClockSpec</span><span class="s2">&gt;;</span>

<span class="s1">export type </span><span class="s3">WorkerMessage </span><span class="s1">= </span><span class="s3">Readonly</span><span class="s2">&lt;{</span>
  <span class="s2">computeDependencies</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">computeSha1</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">dependencyExtractor</span><span class="s1">?: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">enableHastePackages</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">readLink</span><span class="s1">: </span><span class="s3">boolean</span><span class="s2">;</span>
  <span class="s2">rootDir</span><span class="s1">: </span><span class="s3">string</span><span class="s2">;</span>
  <span class="s2">filePath</span><span class="s1">: </span><span class="s3">string</span><span class="s2">;</span>
  <span class="s2">hasteImplModulePath</span><span class="s1">?: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
<span class="s2">}&gt;;</span>

<span class="s1">export type </span><span class="s3">WorkerMetadata </span><span class="s1">= </span><span class="s3">Readonly</span><span class="s2">&lt;{</span>
  <span class="s2">dependencies</span><span class="s1">?: </span><span class="s3">ReadonlyArray</span><span class="s2">&lt;</span><span class="s3">string</span><span class="s2">&gt;;</span>
  <span class="s2">id</span><span class="s1">?: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">module</span><span class="s1">?: </span><span class="s3">ModuleMetaData </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">sha1</span><span class="s1">?: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
  <span class="s2">symlinkTarget</span><span class="s1">?: </span><span class="s3">string </span><span class="s1">| </span><span class="s3">null</span><span class="s2">;</span>
<span class="s2">}&gt;;</span>
</pre>
</body>
</html>