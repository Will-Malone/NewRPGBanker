<html>
<head>
<title>findMatchingSimulator.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #6a8759;}
.s2 { color: #6897bb; font-style: italic;}
.s3 { color: #cc7832; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
findMatchingSimulator.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;findMatchingSimulator&quot;</span><span class="s0">,</span><span class="s1">&quot;simulators&quot;</span><span class="s0">,</span><span class="s1">&quot;findOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;devices&quot;</span><span class="s0">,</span><span class="s1">&quot;simulatorVersion&quot;</span><span class="s0">,</span><span class="s1">&quot;simulatorName&quot;</span><span class="s0">,</span><span class="s1">&quot;simulator&quot;</span><span class="s0">,</span><span class="s1">&quot;parsedSimulatorName&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;fallbackMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;versionDescriptor&quot;</span><span class="s0">,</span><span class="s1">&quot;device&quot;</span><span class="s0">,</span><span class="s1">&quot;version&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;availability&quot;</span><span class="s0">,</span><span class="s1">&quot;isAvailable&quot;</span><span class="s0">,</span><span class="s1">&quot;booted&quot;</span><span class="s0">,</span><span class="s1">&quot;state&quot;</span><span class="s0">,</span><span class="s1">&quot;lastBootedAt&quot;</span><span class="s0">,</span><span class="s1">&quot;simulatorDescriptor&quot;</span><span class="s0">,</span><span class="s1">&quot;udid&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">],</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/tools/findMatchingSimulator.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/**</span><span class="s3">\n </span><span class="s1">* Copyright (c) Facebook, Inc. and its affiliates.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* This source code is licensed under the MIT license found in the</span><span class="s3">\n </span><span class="s1">* LICENSE file in the root directory of this source tree.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">import {Device} from '../types';</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Takes in a parsed simulator list and a desired name, and returns an object with the matching simulator. The desired</span><span class="s3">\n </span><span class="s1">* name can optionally include the iOS version in between parenthesis after the device name. Ex: </span><span class="s3">\&quot;</span><span class="s1">iPhone 6 (9.2)</span><span class="s3">\&quot; </span><span class="s1">in</span><span class="s3">\n </span><span class="s1">* which case it'll attempt to find a simulator with the exact version specified.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* If the simulatorString argument is null, we'll go into default mode and return the currently booted simulator,</span><span class="s3">\n </span><span class="s1">* the last booted simulator or</span><span class="s3">\n </span><span class="s1">* if none is booted, it will be the first in the list.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param simulators a parsed list from `xcrun simctl list --json devices` command</span><span class="s3">\n </span><span class="s1">* @param findOptions null or an object containing:</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">* {</span><span class="s3">\n </span><span class="s1">*    simulator: name of desired simulator</span><span class="s3">\n </span><span class="s1">*    udid: udid of desired simulator</span><span class="s3">\n </span><span class="s1">* }</span><span class="s3">\n </span><span class="s1">* ```</span><span class="s3">\n </span><span class="s1">* If null, it will use the currently booted simulator, or if none are booted, the first in the list.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function findMatchingSimulator(</span><span class="s3">\n  </span><span class="s1">simulators: {devices: {[index: string]: Array&lt;Device&gt;}},</span><span class="s3">\n  </span><span class="s1">findOptions?: null | {simulator?: string; udid?: string},</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (!simulators.devices) {</span><span class="s3">\n    </span><span class="s1">return null;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const devices = simulators.devices;</span><span class="s3">\n  </span><span class="s1">let simulatorVersion;</span><span class="s3">\n  </span><span class="s1">let simulatorName = null;</span><span class="s3">\n\n  </span><span class="s1">if (findOptions &amp;&amp; findOptions.simulator) {</span><span class="s3">\n    </span><span class="s1">const parsedSimulatorName = findOptions.simulator.match(</span><span class="s3">\n      </span><span class="s1">/(.*)? (?:</span><span class="s3">\\</span><span class="s1">((</span><span class="s3">\\</span><span class="s1">d+</span><span class="s3">\\</span><span class="s1">.</span><span class="s3">\\</span><span class="s1">d+)?</span><span class="s3">\\</span><span class="s1">))$/,</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (parsedSimulatorName &amp;&amp; parsedSimulatorName[2] !== undefined) {</span><span class="s3">\n      </span><span class="s1">simulatorVersion = parsedSimulatorName[2];</span><span class="s3">\n      </span><span class="s1">simulatorName = parsedSimulatorName[1];</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">simulatorName = findOptions.simulator;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let match;</span><span class="s3">\n  </span><span class="s1">let fallbackMatch;</span><span class="s3">\n\n  </span><span class="s1">for (const versionDescriptor in devices) {</span><span class="s3">\n    </span><span class="s1">const device = devices[versionDescriptor];</span><span class="s3">\n    </span><span class="s1">let version = versionDescriptor;</span><span class="s3">\n\n    </span><span class="s1">if (/^com</span><span class="s3">\\</span><span class="s1">.apple</span><span class="s3">\\</span><span class="s1">.CoreSimulator</span><span class="s3">\\</span><span class="s1">.SimRuntime</span><span class="s3">\\</span><span class="s1">./g.test(version)) {</span><span class="s3">\n      </span><span class="s1">// Transform </span><span class="s3">\&quot;</span><span class="s1">com.apple.CoreSimulator.SimRuntime.iOS-12-2</span><span class="s3">\&quot; </span><span class="s1">into </span><span class="s3">\&quot;</span><span class="s1">iOS 12.2</span><span class="s3">\&quot;\n      </span><span class="s1">version = version.replace(</span><span class="s3">\n        </span><span class="s1">/^com</span><span class="s3">\\</span><span class="s1">.apple</span><span class="s3">\\</span><span class="s1">.CoreSimulator</span><span class="s3">\\</span><span class="s1">.SimRuntime</span><span class="s3">\\</span><span class="s1">.([^-]+)-([^-]+)-([^-]+)$/g,</span><span class="s3">\n        </span><span class="s1">'$1 $2.$3',</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Making sure the version of the simulator is an iOS or tvOS (Removes Apple Watch, etc)</span><span class="s3">\n    </span><span class="s1">if (!version.includes('iOS')) {</span><span class="s3">\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (simulatorVersion &amp;&amp; !version.endsWith(simulatorVersion)) {</span><span class="s3">\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">for (const i in device) {</span><span class="s3">\n      </span><span class="s1">const simulator = device[i];</span><span class="s3">\n      </span><span class="s1">// Skipping non-available simulator</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">simulator.availability !== '(available)' &amp;&amp;</span><span class="s3">\n        </span><span class="s1">// @ts-ignore verify isAvailable parameter</span><span class="s3">\n        </span><span class="s1">simulator.isAvailable !== 'YES' &amp;&amp;</span><span class="s3">\n        </span><span class="s1">simulator.isAvailable !== true</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">continue;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">const booted = simulator.state === 'Booted';</span><span class="s3">\n      </span><span class="s1">const lastBootedAt = simulator.lastBootedAt;</span><span class="s3">\n      </span><span class="s1">const simulatorDescriptor = {</span><span class="s3">\n        </span><span class="s1">udid: simulator.udid,</span><span class="s3">\n        </span><span class="s1">name: simulator.name,</span><span class="s3">\n        </span><span class="s1">booted,</span><span class="s3">\n        </span><span class="s1">version,</span><span class="s3">\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">if (findOptions &amp;&amp; findOptions.udid) {</span><span class="s3">\n        </span><span class="s1">if (simulator.udid === findOptions.udid) {</span><span class="s3">\n          </span><span class="s1">return simulatorDescriptor;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">if (booted &amp;&amp; simulatorName === null) {</span><span class="s3">\n          </span><span class="s1">return simulatorDescriptor;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">if (simulator.name === simulatorName &amp;&amp; !match) {</span><span class="s3">\n          </span><span class="s1">match = simulatorDescriptor;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// If no match found, use first available simulator that was booted before</span><span class="s3">\n        </span><span class="s1">if (!!lastBootedAt &amp;&amp; !match) {</span><span class="s3">\n          </span><span class="s1">fallbackMatch = simulatorDescriptor;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">// Keeps track of the first available simulator for use if we can't find one above.</span><span class="s3">\n        </span><span class="s1">if (simulatorName === null &amp;&amp; !match) {</span><span class="s3">\n          </span><span class="s1">match = simulatorDescriptor;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return match ?? fallbackMatch ?? null;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export default findMatchingSimulator;</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">}</span></pre>
</body>
</html>